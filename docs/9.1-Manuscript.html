<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Didier Brassard">
<meta name="author" content="Nancy Presse">
<meta name="author" content="Stéphanie Chevalier">
<meta name="dcterms.date" content="2024-12-04">
<meta name="keywords" content="older adults, CFG, Canada’s Food Guide, Dietary intervention, Dietary guidelines, Target trial, Target trial emulation, Hypothetical trial, HEFI-2019, Healthy Eating Food Index-2019">

<title>Brassard, Presse &amp; Chevalier, 2024 - Estimating The Effect Of Adhering To Canada’s Food Guide 2019 Recommendations On Health Outcomes In Older Adults: A Target Trial Emulation Protocol</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Brassard, Presse &amp; Chevalier, 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/didierbrassard/NuAge_protocol/blob/main/README.md"> 
<span class="menu-text">READ ME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./1.0-Data_preparation.html"> <i class="bi bi-database-fill" role="img">
</i> 
<span class="menu-text">Data preparation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./9.1-Manuscript.html" aria-current="page"> <i class="bi bi-file-earmark-text" role="img">
</i> 
<span class="menu-text">Manuscript</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./9.2-Supplement.html"> 
<span class="menu-text">Supplement</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/didierbrassard/NuAge_protocol"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">Repository</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:didier.brassard@mcgill.ca"> <i class="bi bi-envelope" role="img">
</i> 
<span class="menu-text">Email</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Estimating The Effect Of Adhering To Canada’s Food Guide 2019 Recommendations On Health Outcomes In Older Adults: A Target Trial Emulation Protocol</h1>
<p class="subtitle lead">Manuscript</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Didier Brassard <a href="mailto:didier.brassard@mcgill.ca" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-7064-3066" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            School of Human Nutrition, McGill University
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Nancy Presse <a href="mailto:Nancy.Presse@USherbrooke.ca" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-5831-8666" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Faculty of Medicine and Health Sciences, University of Sherbrooke
          </p>
        <p class="affiliation">
            Centre de recherche sur le vieillissement, CIUSSS de l’Estrie-CHUS
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Stéphanie Chevalier <a href="mailto:stephanie.chevalier@mcgill.ca" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0002-8497-1570" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            School of Human Nutrition, McGill University
          </p>
        <p class="affiliation">
            Research Institute of the McGill University Health Centre
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 4, 2024</p>
    </div>
  </div>
  
    
  </div>
  

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>older adults, CFG, Canada’s Food Guide, Dietary intervention, Dietary guidelines, Target trial, Target trial emulation, Hypothetical trial, HEFI-2019, Healthy Eating Food Index-2019</p>
  </div>
</div>

</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#abstract" id="toc-abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction">Introduction</a></li>
  <li><a href="#methods" id="toc-methods">Methods</a>
  <ul>
  <li><a href="#research-question-and-hypothesis" id="toc-research-question-and-hypothesis">Research Question and Hypothesis</a></li>
  <li><a href="#study-design-and-sample" id="toc-study-design-and-sample">Study Design and Sample</a></li>
  <li><a href="#target-trial" id="toc-target-trial">Target trial</a>
  <ul>
  <li><a href="#eligibility-criteria" id="toc-eligibility-criteria">Eligibility Criteria</a></li>
  <li><a href="#hypothetical-interventions" id="toc-hypothetical-interventions">Hypothetical Interventions</a></li>
  <li><a href="#assignment" id="toc-assignment">Assignment</a></li>
  <li><a href="#outcomes" id="toc-outcomes">Outcomes</a></li>
  <li><a href="#time-zero-and-follow-up" id="toc-time-zero-and-follow-up">Time Zero and Follow-up</a></li>
  <li><a href="#causal-contrast" id="toc-causal-contrast">Causal Contrast</a></li>
  <li><a href="#statistical-analysis" id="toc-statistical-analysis">Statistical Analysis</a></li>
  </ul></li>
  <li><a href="#ethical-considerations" id="toc-ethical-considerations">Ethical Considerations</a>
  <ul>
  <li><a href="#human-subject-ethics-review-approvals-or-exemptions" id="toc-human-subject-ethics-review-approvals-or-exemptions">Human subject ethics review approvals or exemptions</a></li>
  <li><a href="#informed-consent" id="toc-informed-consent">Informed Consent</a></li>
  <li><a href="#privacy-and-confidentiality" id="toc-privacy-and-confidentiality">Privacy and confidentiality</a></li>
  <li><a href="#compensation-details" id="toc-compensation-details">Compensation details</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results">Results</a></li>
  <li><a href="#discussion" id="toc-discussion">Discussion</a>
  <ul>
  <li><a href="#limitations" id="toc-limitations">Limitations</a></li>
  <li><a href="#conclusion" id="toc-conclusion">Conclusion</a></li>
  </ul></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements">Acknowledgements</a>
  <ul>
  <li><a href="#authors-contributions" id="toc-authors-contributions">Authors’ contributions</a></li>
  <li><a href="#conflicts-of-interest" id="toc-conflicts-of-interest">Conflicts of Interest</a></li>
  <li><a href="#funding-statement" id="toc-funding-statement">Funding statement</a></li>
  <li><a href="#data-availability-and-code" id="toc-data-availability-and-code">Data availability and code</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references">References</a></li>
  <li><a href="#abbreviations" id="toc-abbreviations">Abbreviations</a></li>
  </ul>
</nav>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>print_table <span class="ot">&lt;-</span> <span class="st">"Y"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Quarto set-up                  #</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">dpi =</span> <span class="dv">300</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">out.width =</span> <span class="st">"80%"</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.env =</span> <span class="st">"figure"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fig.align =</span> <span class="st">"center"</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">## suppress scientific notation</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">9999</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************** #</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Packages                      #</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************** #</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="do">## data</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidylog)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="do">## analysis</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hefi2019)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="do">## results presentation</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytex)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MetBrewer)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dagitty)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co">#               Location of files                #</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>dir_scripts <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"scripts"</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>dir_processed <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"processed"</span>)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>dir_results <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"results"</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>dir_tab <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"manuscript"</span>, <span class="st">"tables"</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">dir.exists</span>(dir_tab)<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(dir_tab, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>dir_fig <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"manuscript"</span>, <span class="st">"figures"</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">dir.exists</span>(dir_fig)<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(dir_fig, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>dir_supp <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"manuscript"</span>, <span class="st">"supplementary"</span>)</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">dir.exists</span>(dir_supp)<span class="sc">==</span><span class="cn">FALSE</span>){</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dir.create</span>(dir_supp, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co">#            Load functions and data             #</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">file.path</span>(dir_processed, <span class="st">"dietsim_hefi.rdata"</span>))</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="do">## GT Table style</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>  gtstyle <span class="ot">&lt;-</span> <span class="cf">function</span>(gtobject,<span class="at">footnote_marker=</span><span class="st">"numbers"</span>){</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    gtobject <span class="sc">|&gt;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>      gt<span class="sc">::</span><span class="fu">tab_style</span>(</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>          <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)  ),</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">locations =</span> <span class="fu">cells_row_groups</span>(<span class="at">groups =</span> <span class="fu">everything</span>())</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>      gt<span class="sc">::</span><span class="fu">opt_align_table_header</span>(<span class="st">"left"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>      gt<span class="sc">::</span><span class="fu">opt_footnote_marks</span>(<span class="at">marks=</span>footnote_marker)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="page-break-after: always;"></div>
<section id="abstract" class="level1">
<h1>Abstract</h1>
<p><strong>Background</strong>: The Canada’s Food Guide 2019 (CFG) provides universal recommendations to individuals aged 2 years or older. The extent to which these recommendations are appropriate for older adults is unknown. Although ideal, conducting a large randomized controlled trial is unrealistic in the short term. An alternative is the target trial emulation framework for causal inference, a novel approach to improve the analysis of observational data.</p>
<p><strong>Objectives</strong>: Our aim is to describe the protocol of a target trial emulation in older adults with emphasis on key aspects of a hypothetical sustained diet and physical activity intervention.</p>
<p><strong>Methods</strong>: To emulate the target trial, non-experimental data from the NuAge longitudinal study (n=1753, adults aged 67 years or older) will be used. NuAge includes 4 yearly measurements of dietary intakes, covariates and outcomes. The per protocol causal contrast will be the primary causal contrast of interest to account for non-adherence. The sustained intervention strategy will be modelled using the parametric g-formula. In the hypothetical trial, participants would be instructed to meet sex-specific minimal intakes for vegetables and fruits, whole grains, animal- and plant-based protein foods, milk &amp; plant-based beverages and unsaturated fats. Eligibility criteria, follow-up, intervention, outcomes, and causal contrast will be similar in the emulation to the target trial except for minor modifications. We will attempt to emulate randomization of treatment by adjusting for baseline covariates and pre-baseline dietary habits.</p>
<p><strong>Results</strong>: Data collection for the NuAge study was completed in June 2008. For the present work, the main analysis has started in May 2024. Submission of the manuscript is expected by December 2024.</p>
<p><strong>Conclusion</strong>: Emulating a target trial will provide the first evidence of the adequacy of CFG 2019 recommendations for older adults in relation to health outcomes.</p>
<p><strong>Keywords:</strong> aged; CFG; Canada’s Food Guide; diet; dietary guidelines; target trial; target trial emulation; hypothetical trial; HEFI-2019; Healthy Eating Food Index-2019.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The latest edition of Canada’s Food Guide (CFG) was published in 2019 <span class="citation" data-cites="healthcanada2019">[<a href="#ref-healthcanada2019" role="doc-biblioref">1</a>]</span>. Compared with the previous edition, key changes include the removal of the pre-specified number of servings to consume each day, a shift towards qualitative (“eat plenty of…”) instead of quantitative recommendations and the provision of universal recommendations instead of age and sex-specific recommendations. In addition, CFG recommendations primarily aim at reducing chronic disease risk. Indeed, the evidence behind CFG’s recommendations concern mitigation of cardiovascular disease, cancer and type 2 diabetes risk <span class="citation" data-cites="healthcanada2018">[<a href="#ref-healthcanada2018" role="doc-biblioref">2</a>]</span>. However, evidence from a nationally representative survey of adults aged 65 years or older from Canada suggested that greater adherence to recommendations was insufficient to meet calcium, vitamin D and folate requirements <span class="citation" data-cites="brassard2023">[<a href="#ref-brassard2023" role="doc-biblioref">3</a>]</span>. In Canada, one third of community-dwelling older adults are at high nutrition risk <span class="citation" data-cites="ramagemorin2013 mills2023">[<a href="#ref-ramagemorin2013" role="doc-biblioref">4</a>,<a href="#ref-mills2023" role="doc-biblioref">5</a>]</span>, highlighting the importance of maintaining adequate nutritional status in this stratum of the population. Similarly, in absence of specific recommendations on the amount of protein foods to eat, older adults may be eating less protein than required to maintain muscle mass <span class="citation" data-cites="bauer2013 deutz2014 paddonjones2015">[<a href="#ref-bauer2013" role="doc-biblioref">6</a>–<a href="#ref-paddonjones2015" role="doc-biblioref">8</a>]</span>. Canada’s Food Guide also provide brief physical activity recommendation, but without explicit acknowledgement of the importance of these recommendations for older adults <span class="citation" data-cites="healthcanada2019">[<a href="#ref-healthcanada2019" role="doc-biblioref">1</a>]</span>. Indeed, performing a minimal amount of physical activity is paramount to maintaining muscle mass <span class="citation" data-cites="bauer2013 deutz2014">[<a href="#ref-bauer2013" role="doc-biblioref">6</a>,<a href="#ref-deutz2014" role="doc-biblioref">7</a>]</span>. Thus, the universal recommendations in CFG may not be appropriate for older adults since they face unique challenges to consuming a healthy diet <span class="citation" data-cites="remond2015">[<a href="#ref-remond2015" role="doc-biblioref">9</a>]</span>, and may require specific nutritional strategies <span class="citation" data-cites="shlisky2017">[<a href="#ref-shlisky2017" role="doc-biblioref">10</a>]</span>.</p>
<p>Ideally, a randomized controlled trial (RCT) would be conducted to investigate the adequacy of CFG recommendations in older adults. However, such RCT is unlikely to be conducted in the short term. An alternative is the target trial emulation framework for causal effect estimation using observational data <span class="citation" data-cites="hernan2016a kutcher2021 tobias2021 hernan2022">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>–<a href="#ref-hernan2022" role="doc-biblioref">14</a>]</span>. Informally, the target trial emulation framework is intended to highlight and address design issues of observational data analysis that aims to estimate a causal effect by explicitly emulating a hypothetical trial <span class="citation" data-cites="hernan2016a">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>]</span>. In nutritional epidemiology, common issues with design and analyses can yield results that are largely inconsistent with those of randomized trials <span class="citation" data-cites="stern2024">[<a href="#ref-stern2024" role="doc-biblioref">15</a>]</span>. For example, the lack of consideration of the compositional nature of diet can dramatically influence effect estimates, i.e., that increasing the intake of one food must compensated by decreasing the intake of another food in substitution modeling <span class="citation" data-cites="tobias2022 tomova2022b stern2024">[<a href="#ref-stern2024" role="doc-biblioref">15</a>–<a href="#ref-tomova2022b" role="doc-biblioref">17</a>]</span>. Furthermore, diet is a lifelong sustained exposure. In an observational study, the effect of diet assessed at a given time may actually reflect the cumulative exposure to prior dietary habits. In turn, ignoring prior dietary habits may result in a misalignment of “time zero” <span class="citation" data-cites="hernan2016c">[<a href="#ref-hernan2016c" role="doc-biblioref">18</a>]</span>, since dietary habits are not randomly assigned at the beginning of the observational study. In other words, ignoring prior dietary habits makes it impossible to distinguish the effect due to prospective (hypothetical) dietary modification from the effect due to retrospective dietary habits. The target trial framework is a helpful tool to highlight and address common issues in nutritional epidemiology. Ultimately, a successful emulation of the target trial based on observational data could yield effect estimates that more closely align with those of a hypothetical future RCT. Example applications of the target trial framework include the emulation of interventions on diet <span class="citation" data-cites="chiu2021 berkowitz2023 bonekamp2023 ibsen2023">[<a href="#ref-chiu2021" role="doc-biblioref">19</a>–<a href="#ref-ibsen2023" role="doc-biblioref">22</a>]</span>, physical activity <span class="citation" data-cites="dickerman2019">[<a href="#ref-dickerman2019" role="doc-biblioref">23</a>]</span>, or both <span class="citation" data-cites="guo2024">[<a href="#ref-guo2024" role="doc-biblioref">24</a>]</span>.</p>
<p>To the best of our knowledge, the target trial framework has not been used to assess the effect of adhering to CFG’s recommendations. Accordingly, the objectives of the present study are, first, to describe the protocol of the emulation of a target trial using observational data from the NuAge study <span class="citation" data-cites="gaudreau2007">[<a href="#ref-gaudreau2007" role="doc-biblioref">25</a>]</span>, a cohort of 1753 adults aged 67 to 84 years at baseline, and, second, to address key aspects of the target trial emulation in the context of a sustained lifestyle intervention strategy involving diet and physical activity. Key aspects are the description of the sustained lifestyle intervention strategy, the attempt to emulate randomization, as well as assumptions and limitations specific to diet intervention. Of note, more general introductory texts to the target trial framework are available elsewhere <span class="citation" data-cites="hernan2016a kutcher2021 hernan2022">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>,<a href="#ref-kutcher2021" role="doc-biblioref">12</a>,<a href="#ref-hernan2022" role="doc-biblioref">14</a>]</span>.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="research-question-and-hypothesis" class="level2">
<h2 class="anchored" data-anchor-id="research-question-and-hypothesis">Research Question and Hypothesis</h2>
<p>Explicitly acknowledging the causal nature of a research question is prerequisite to causal effect estimation using observational data <span class="citation" data-cites="hernan2018 goetghebeur2020 haber2022">[<a href="#ref-hernan2018" role="doc-biblioref">26</a>–<a href="#ref-haber2022" role="doc-biblioref">28</a>]</span>. The general objective of this study will be to examine the adequacy of CFG’s universal dietary recommendations for older adults. Expressed as a counterfactual statement, our objective is to answer the following question:</p>
<blockquote class="blockquote">
<p>What would be the difference in a given health outcome at the end of the follow-up, if all eligible participants had increased their adherence to CFG recommendations on healthy food choices compared with, instead, if they had maintained their habitual diet?</p>
</blockquote>
<p>Specifically, among adults aged 67 to 84 years followed over 3 years, and compared with maintenance of habits, we aim to:</p>
<ol type="1">
<li>Estimate the causal effect of adhering to CFG’s dietary recommendations on markers of muscle health (e.g., physical function, muscle strength), general health (e.g., waist circumference, blood pressure, glucose), and cognitive health (i.e., Modified Mini-Mental State Exam) .</li>
</ol>
<p><em>Hypothesis: adhering to recommendations positively influence general and cognitive health but has no influence on muscle health.</em></p>
<ol start="2" type="1">
<li>Estimate the causal effect of adhering to a <em>reformulation</em> of CFG’s dietary recommendations, including more protein foods and a minimal physical activity recommendation, to amplify the positive health effects.</li>
</ol>
<p><em>Hypothesis: increasing the consumption of protein-rich foods positively influence muscle health, and meeting minimal physical activity recommendation (30 minutes or more per day) further amplifies positive health effects.</em></p>
</section>
<section id="study-design-and-sample" class="level2">
<h2 class="anchored" data-anchor-id="study-design-and-sample">Study Design and Sample</h2>
<p>Data from the NuAge prospective cohort study will be used to emulate the target trial <span class="citation" data-cites="gaudreau2007">[<a href="#ref-gaudreau2007" role="doc-biblioref">25</a>]</span>. The NuAge cohort comprised 1753 generally healthy community-dwelling adults aged 67 to 84 years at baseline and followed over 3 years. The baseline and each annual follow-up included comprehensive assessment on sociodemographic data, diet, physical activity, functional status as well as physical and mental health <span class="citation" data-cites="gaudreau2007">[<a href="#ref-gaudreau2007" role="doc-biblioref">25</a>]</span>.</p>
<p>The NuAge study sample is relevant to our research question. The target population of CFG recommendations comprise all individuals aged 2 years or older, which is compatible with the target sample of the NuAge study of generally healthy older adults from the greater Montreal, Sherbrooke and Laval areas, the province of Quebec, Canada.</p>
</section>
<section id="target-trial" class="level2">
<h2 class="anchored" data-anchor-id="target-trial">Target trial</h2>
<p>The target trial framework has been suggested as a potential solution to improve the analysis of nutritional epidemiology studies aiming at causal inference <span class="citation" data-cites="tobias2021">[<a href="#ref-tobias2021" role="doc-biblioref">13</a>]</span>. Informally, the target trial framework helps to align the observational data analysis with that of a hypothetical trial. This framework is appropriate for the research question in the present study, since we aim to estimate the effect of adhering to a hypothetical diet and physical activity intervention using on observational data. The first step of a target trial emulation is the description of the target trial, i.e., the protocol of the hypothetical randomized controlled trial we would like to conduct <span class="citation" data-cites="hernan2016a hernan2022">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>,<a href="#ref-hernan2022" role="doc-biblioref">14</a>]</span>. The second step is the emulation, i.e., describing how to target trial is emulated and conducting the study described in the present protocol.</p>
<p><strong>Table 1</strong> presents the target trial and its emulation using observational data from the NuAge study. Key differences between the target trial and its emulation are that participants will be required to provide complete dietary assessment and covariate data at baseline (eligibility component); and that we will attempt to emulate the randomized assignment by adjusting for dietary intakes before baseline as well as baseline covariates (assignment component).</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| label: tbl-target</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #| tbl-cap: "Target trial"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#               Generate table presenting the target trial                #</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>tab_targettrial <span class="ot">&lt;-</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(dir_results,<span class="st">"Table_data.xlsx"</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">"targettrial"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_label</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">component =</span> <span class="st">"Trial component"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">target  =</span> <span class="st">"Target trial specification"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">emulation =</span> <span class="st">"Target trial emulation"</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_style</span>(</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns=</span><span class="dv">1</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_style</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">list</span>(</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>)  ),</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns=</span><span class="fu">everything</span>())</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Emulation of a dietary intervention target trial</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="st">     using observational data from the NuAge study"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"FFQ, food-frequency questionnaire; NuAge, Quebec Longitudinal Study on Nutrition and Successful Aging"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="st">"title"</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"See 'Dietary Strategies' for detailed intervention."</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns=</span><span class="st">"component"</span>,<span class="at">rows=</span><span class="dv">2</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"The observational analog of the intention-to-treat contrast corresponds to the baseline values of the intervention, which are both 'assigned' and initiated at the same time."</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(<span class="at">columns=</span><span class="st">"component"</span>, <span class="at">rows=</span><span class="dv">6</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="co">#                  Print table                   #</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(print_table<span class="sc">==</span><span class="st">"Y"</span>) {</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>tab_targettrial <span class="sc">|&gt;</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gtstyle</span>()</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="gvpujsoazb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gvpujsoazb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gvpujsoazb thead, #gvpujsoazb tbody, #gvpujsoazb tfoot, #gvpujsoazb tr, #gvpujsoazb td, #gvpujsoazb th {
  border-style: none;
}

#gvpujsoazb p {
  margin: 0;
  padding: 0;
}

#gvpujsoazb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gvpujsoazb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gvpujsoazb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gvpujsoazb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gvpujsoazb .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gvpujsoazb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gvpujsoazb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gvpujsoazb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gvpujsoazb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gvpujsoazb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gvpujsoazb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gvpujsoazb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gvpujsoazb .gt_spanner_row {
  border-bottom-style: hidden;
}

#gvpujsoazb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gvpujsoazb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gvpujsoazb .gt_from_md > :first-child {
  margin-top: 0;
}

#gvpujsoazb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gvpujsoazb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gvpujsoazb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gvpujsoazb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gvpujsoazb .gt_row_group_first td {
  border-top-width: 2px;
}

#gvpujsoazb .gt_row_group_first th {
  border-top-width: 2px;
}

#gvpujsoazb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvpujsoazb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gvpujsoazb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gvpujsoazb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gvpujsoazb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvpujsoazb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gvpujsoazb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gvpujsoazb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gvpujsoazb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gvpujsoazb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gvpujsoazb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvpujsoazb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gvpujsoazb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gvpujsoazb .gt_left {
  text-align: left;
}

#gvpujsoazb .gt_center {
  text-align: center;
}

#gvpujsoazb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gvpujsoazb .gt_font_normal {
  font-weight: normal;
}

#gvpujsoazb .gt_font_bold {
  font-weight: bold;
}

#gvpujsoazb .gt_font_italic {
  font-style: italic;
}

#gvpujsoazb .gt_super {
  font-size: 65%;
}

#gvpujsoazb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gvpujsoazb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gvpujsoazb .gt_indent_1 {
  text-indent: 5px;
}

#gvpujsoazb .gt_indent_2 {
  text-indent: 10px;
}

#gvpujsoazb .gt_indent_3 {
  text-indent: 15px;
}

#gvpujsoazb .gt_indent_4 {
  text-indent: 20px;
}

#gvpujsoazb .gt_indent_5 {
  text-indent: 25px;
}

#gvpujsoazb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gvpujsoazb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border">Emulation of a dietary intervention target trial using observational data from the NuAge study<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
<tr class="odd gt_col_headings">
<th id="component" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Trial component</th>
<th id="target" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Target trial specification</th>
<th id="emulation" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Target trial emulation</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="component" style="font-weight: bold">Eligibility criteria</td>
<td class="gt_row gt_left" headers="target">NuAge inclusion criteria: individuals aged 67-84 y; living in Montreal, Laval or Sherbrooke; not cognitively impaired, free of disabilities in activities of daily living. Exclusion criteria: class II heart failure, chronic obstructive pulmonary disease requiring home oxygen therapy or oral steroids, inflammatory digestive diseases, and cancer treatment in the past 5 years.</td>
<td class="gt_row gt_left" headers="emulation">Same. Participants will also be required to have complete baseline dietary assessment (at least one 24-hour recall with 500 kcal or more and FFQ) and baseline covariate data</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="component" style="font-weight: bold">Intervention<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span></td>
<td class="gt_row gt_left" headers="target">Each individual would be assigned to 1 of the 4 following strategies: 1) control group (habitual diet, i.e., typical North American); 2) adherence to Canada's Food Guide recommendations on healthy food choices; 3) same as 2) but including a 'high-protein' reformulation; 4) same as 3) but including a minimal physical activity component. Each strategy is followed until the end of follow-up. Participants assigned to a lifestyle strategy are expected to maintain their dietary intake or amount of physical activity at or above the prespecified threshold by the corresponding intervention strategy.</td>
<td class="gt_row gt_left" headers="emulation">Same. We will assume that each dietary assessment period (i.e., within 2 months beginning at each timepoint) accurately reflects the average diet in the interval between follow-ups.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="component" style="font-weight: bold">Assignment</td>
<td class="gt_row gt_left" headers="target">Participants are randomly assigned to a dietary strategy, but are not blinded to their assignment.</td>
<td class="gt_row gt_left" headers="emulation">We will attempt to emulate randomized assignment by adjusting for dietary intakes before baseline and baseline covariates.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="component" style="font-weight: bold">Outcomes</td>
<td class="gt_row gt_left" headers="target">Physical function and muscle strength, general health indicators, and cognitive health</td>
<td class="gt_row gt_left" headers="emulation">Same.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="component" style="font-weight: bold">Time zero and follow-up</td>
<td class="gt_row gt_left" headers="target">Starts at baseline and ends at incomplete follow-up, or 3 y after baseline, whichever occurs first.</td>
<td class="gt_row gt_left" headers="emulation">Same. An incomplete follow-up is defined as missing data for questionnaires (non-response or loss to follow-up) or missing outcome data at the end of follow-up.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="component" style="font-weight: bold">Causal contrast<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></td>
<td class="gt_row gt_left" headers="target">• Intention-to-treat effect • Per-protocol effect</td>
<td class="gt_row gt_left" headers="emulation">Observational analog of both contrasts: • Intention-to-treat effect (secondary) • Per-protocol effect (primary)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="component" style="font-weight: bold">Statistical analysis</td>
<td class="gt_row gt_left" headers="target">• Intention-to-treat analysis: apply inverse probability weighting with adjustment for pre- and baseline factors associated with incomplete follow-up to account for study dropouts • Per-protocol analysis: apply the parametric g-formula algorithm to compare post-intervention outcomes between groups receiving each treatment strategy with adjustment for pre- and postbaseline factors associated with adherence to intervention strategies and incomplete follow-up.</td>
<td class="gt_row gt_left" headers="emulation">Same for both contrasts. Except that the observational analog will require additional adjustment for confounding at baseline and before baseline due to prior diet.</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> FFQ, food-frequency questionnaire; NuAge, Quebec Longitudinal Study on Nutrition and Successful Aging</td>
</tr>
<tr class="even">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> See 'Dietary Strategies' for detailed intervention.</td>
</tr>
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> The observational analog of the intention-to-treat contrast corresponds to the baseline values of the intervention, which are both 'assigned' and initiated at the same time.</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Save table                   #</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gtsave</span>(tab_targettrial,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">filename =</span> <span class="fu">file.path</span>(dir_tab,<span class="st">"tab_targettrial.docx"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Each part of the target trial and its emulation are described below.</p>
<section id="eligibility-criteria" class="level3">
<h3 class="anchored" data-anchor-id="eligibility-criteria">Eligibility Criteria</h3>
<p>The inclusion criteria for the target trial are the same as for the NuAge study <span class="citation" data-cites="gaudreau2007">[<a href="#ref-gaudreau2007" role="doc-biblioref">25</a>]</span>. In the emulation, participants will be required to have at least one 24-hour dietary recall completed at baseline with 500 calories or more, as well as complete covariate data at baseline, as identified below.</p>
</section>
<section id="hypothetical-interventions" class="level3">
<h3 class="anchored" data-anchor-id="hypothetical-interventions">Hypothetical Interventions</h3>
<p>The hypothetical intervention strategies evaluated will be:</p>
<ol type="1">
<li>no change in dietary habits or physical activity (“control” intervention);</li>
<li>adherence to CFG’s recommendations;</li>
<li>adherence to CFG’s recommendations including reformulation (i.e., higher intake of protein foods);</li>
<li>adherence to CFG’s recommendations including reformulation (i.e., higher intake of protein foods) and performing at least 30 minutes of aerobic physical activity.</li>
</ol>
<p>Physical activity recommendations are not traditionally at the forefront of CFG’s recommendations. However, CFG does mention that “<em>at least 150 minutes of moderate-to vigorous-intensity aerobic physical activity per week […] is recommended to achieve health benefits</em>” <span class="citation" data-cites="healthcanada2019">[<a href="#ref-healthcanada2019" role="doc-biblioref">1</a>]</span>. Thus, recognizing the key role of exercise to maintaining health and muscle for older adults, the 4<sup>th</sup> hypothetical intervention includes a formal physical activity recommendation. In the target trial, the physical activity corresponds to performing aerobic exercise of light to vigorous-intensity aerobic for at least 30 minutes per day <span class="citation" data-cites="bauer2013">[<a href="#ref-bauer2013" role="doc-biblioref">6</a>]</span>.</p>
<section id="the-challenge-of-a-well-defined-nutritional-intervention" class="level4">
<h4 class="anchored" data-anchor-id="the-challenge-of-a-well-defined-nutritional-intervention">The challenge of a well-defined nutritional intervention</h4>
<p>Emulating a well-defined dietary intervention for CFG’s recommendations is challenging. First, recommendations in the latest edition of CFG are qualitative and flexible (e.g., “<em>Eat plenty of vegetables and fruits</em>”; <span class="citation" data-cites="healthcanada2019 brassard2022a">[<a href="#ref-healthcanada2019" role="doc-biblioref">1</a>,<a href="#ref-brassard2022a" role="doc-biblioref">29</a>]</span>). Thus, multiple suitable, but nonetheless very different, dietary patterns can achieve adherence to recommendations. Second, CFG’s recommendations target both food intakes (e.g., vegetables and fruits) and nutrients (e.g., saturated fats). The nutrient-based recommendations can be achieved by intervening on the consumption of multiple different foods. For example, to achieve the hypothetical intervention “<em>decreasing consumption of calories from saturated fats</em>” one could decrease saturated fats from dairy, nuts and low nutritive value foods altogether. Arguably, the relationship between these food categories and a given health outcome may vary greatly.</p>
<p>To estimate a causal effect using observational data, the hypothetical interventions must be sufficiently well-defined or that until “no meaningful variation” of that intervention remains <span class="citation" data-cites="hernan2016b chiu2022">[<a href="#ref-hernan2016b" role="doc-biblioref">30</a>,<a href="#ref-chiu2022" role="doc-biblioref">31</a>]</span>. In other words, the hypothetical diet interventions should be elaborated until no additional dietary characteristics are deemed impactful in regards of the outcome of interest. Another consideration is that the modelling of hypothetical interventions should ideally be conducted with dietary intakes expressed using the same units. For example, mixing food intakes expressed in servings and grams in a statistical model may cause poor estimation of causal effects <span class="citation" data-cites="tomova2022b">[<a href="#ref-tomova2022b" role="doc-biblioref">17</a>]</span>. Finally, the statistical approach used to account for ‘total energy’ or total food intake also affects the causal effect of interest and should be consistent with the research question <span class="citation" data-cites="kipnis1993 tomova2022a tomova2022b chiu2022">[<a href="#ref-tomova2022b" role="doc-biblioref">17</a>,<a href="#ref-chiu2022" role="doc-biblioref">31</a>–<a href="#ref-tomova2022a" role="doc-biblioref">33</a>]</span>.</p>
</section>
<section id="diet-simulations" class="level4">
<h4 class="anchored" data-anchor-id="diet-simulations">Diet Simulations</h4>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#             Output sim. diet data              #</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># note: loading done in set-up chunk. See code &lt;1.0-Data_preparation.R&gt; for details</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#          Output vectors of CFG foods           #</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>recommended <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"vegetables and fruits"</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"whole-grain foods"</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"protein foods"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"unsweetened milk and plant-based beverages with protein"</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>notrecommended <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"non-whole grain foods"</span>,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"other low nutritive value foods"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"juice, sugary drinks and alcohol"</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fatty foods rich in saturated fats"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For the present study, adherence to CFG’s recommendations was defined based on simulated diets generated by Health Canada <span class="citation" data-cites="healthcanada2022">[<a href="#ref-healthcanada2022" role="doc-biblioref">34</a>]</span> and summarized in <strong>Supplemental Table 1</strong>. The simulated diets were designed to meet both CFG’s recommendations on healthy food choices and nutrient requirements (Dietary Reference Intake).</p>
<p>These diets achieve near perfect Healthy Eating Food Index (HEFI)-2019 scores (&gt;78/80) through relatively high intakes of recommended foods (i.e., vegetables and fruits, whole-grain foods, protein foods, and unsweetened milk and plant-based beverages with protein) and null intakes of foods not recommended (i.e., non-whole grain foods, other low nutritive value foods, juice, sugary drinks and alcohol, and fatty foods rich in saturated fats). The HEFI-2019 score indicates the extent to which dietary intakes are consistent with CFG’s recommendations on healthy food choices <span class="citation" data-cites="brassard2022a brassard2022b">[<a href="#ref-brassard2022a" role="doc-biblioref">29</a>,<a href="#ref-brassard2022b" role="doc-biblioref">35</a>]</span>.</p>
<p>Note that the HEFI-2019 could have been used as main exposure to measure adherence to CFG. However, the use of a composite score metric would not fully satisfy the criterion of a well-defined intervention to estimate a causal effect. First, high HEFI-2019 scores, and high adherence to CFG’s recommendations, can be achieved through many different strategies or dietary patterns. In the context of observational data, the specific strategies through which individuals achieve high HEFI-2019 score would be based on dietary habits and patterns self-selected by the participants. This approach is similar to asking hypothetical trial participants to modify their intakes without clearly indicating how, which would obscure the causal effect estimated. Second, the HEFI-2019 score includes recommendations both on foods and on nutrients. As described above, mixing servings and grams in a statistical models may cause poor estimation of causal effects <span class="citation" data-cites="tomova2022b">[<a href="#ref-tomova2022b" role="doc-biblioref">17</a>]</span>.</p>
<p>We stress that the diets simulated by Health Canada were not actually consumed by older adults. For this reason, the simulated values for vegetables and fruits, whole-grain foods and plant-based protein foods <em>exceed</em> the 99<sup>th</sup> percentile of the distribution of usual intakes of these food categories as estimated in adults aged 65 years or more from the Canadian Community Health Survey 2015 - Nutrition <span class="citation" data-cites="brassard2023">[<a href="#ref-brassard2023" role="doc-biblioref">3</a>]</span>. In <strong>Table 2</strong>, the target intakes vegetables and fruits, whole grains, and plant-based protein foods for the adhering to Canada’s Food Guide 2019 recommendations intervention were revised to correspond, at most, to the 90<sup>th</sup> percentile of the distribution of usual intakes among Canadians aged 65 years or more in 2015 <span class="citation" data-cites="brassard2023">[<a href="#ref-brassard2023" role="doc-biblioref">3</a>]</span>. Since Canada’s Food Guide 2019 does not have a portion size system, reference amounts (RA) were used as a proxy for servings. RA are regulated quantity of foods that reflect the portion size typically consumed at 1 sitting in Canada. RA were used by Health Canada to simulate diet consistent with Canada’s Food Guide 2019 recommendations and Dietary Reference Intake (Supplemental Table 1), hence RAs are adequate for the present work.</p>
</section>
<section id="implementation" class="level4">
<h4 class="anchored" data-anchor-id="implementation">Implementation</h4>
<p>In the target trial, the sustained intervention strategy could be implemented as follows:</p>
<ol type="1">
<li>the participant’s usual dietary intakes and physical activity would be assessed by research dietitians at each study visit;</li>
<li>if reported food intakes and duration of physical activity were <strong>equal to or above</strong> the prespecified thresholds (Table 2), no change would be suggested to the participants’ diet or physical activity If food intakes or duration of physical activity were <strong>below</strong> the prespecified thresholds, participants would be instructed to increase food consumption to exactly the prespecified portions or increase physical activity duration to 30 minutes per day (when applicable);</li>
<li>if changes are required, participants would be instructed to decrease consumption of foods not recommended to the extent of the increase in (2). For example, if a 2-serving increase in vegetables and fruits is required to meet the pre-specified intervention thresholds, participants would be instructed to substitute 2 servings of vegetables and fruits for non-whole grain foods, other low nutritive value foods, juice, sugary drinks and alcohol, and fatty foods rich in saturated fats.</li>
</ol>
<p>In the emulation, for all hypothetical interventions, the substitution will be implemented by including “total intakes” as a covariate and leaving out foods not recommended from the models. More precisely, a variable reflecting total food intake (in RA/day) and a variable reflecting total beverage intake (in RA/day) will be included in all models. Hence, total food and beverage intakes will be constant across hypothetical diet interventions. In this approach to account for “total energy”, all model coefficients reflect the action of increasing intakes of recommended foods and a concomitant decrease in <em>any</em> of the foods not recommended <span class="citation" data-cites="kipnis1993">[<a href="#ref-kipnis1993" role="doc-biblioref">32</a>]</span>. On the one hand, this approach is potentially confusing <span class="citation" data-cites="tomova2022a tomova2022b">[<a href="#ref-tomova2022b" role="doc-biblioref">17</a>,<a href="#ref-tomova2022a" role="doc-biblioref">33</a>]</span>, since the default interpretation of model coefficients is the action of increasing the intake of each <strong>food included in the model</strong>, while decreasing the intake of foods <strong>not in the model</strong> <span class="citation" data-cites="kipnis1993">[<a href="#ref-kipnis1993" role="doc-biblioref">32</a>]</span>. On the other hand, the standard model is generally consistent with the implementation of dietary intervention in feeding trials <span class="citation" data-cites="willett2013 tobias2022 willett2022">[<a href="#ref-tobias2022" role="doc-biblioref">16</a>,<a href="#ref-willett2013" role="doc-biblioref">36</a>,<a href="#ref-willett2022" role="doc-biblioref">37</a>]</span>. The standard model also reduces the number of variables to be considered as intervention variables. Otherwise, 4 additional dietary components would have to be modelled for foods not recommended (i.e., non-whole grain foods, other low nutritive value foods, juice, sugary drinks and alcohol, and fatty foods rich in saturated fats). Finally, the explicit description of the intervention strategies in the target trial protocol clarifies the estimand of interest, as done previously <span class="citation" data-cites="chiu2021 chiu2022">[<a href="#ref-chiu2021" role="doc-biblioref">19</a>,<a href="#ref-chiu2022" role="doc-biblioref">31</a>]</span>.</p>
<p>Of note, nutrient-based recommendations in CFG (i.e, saturated fats, free sugars and sodium) are not explicitly modelled to avoid the problems associated with mixed-unit models <span class="citation" data-cites="tomova2022b">[<a href="#ref-tomova2022b" role="doc-biblioref">17</a>]</span>. In the target trial, we assume that nutrient-based targets would be met by reducing consumption of foods not recommended (i.e., non-whole grain foods, other low nutritive value foods, juice, sugary drinks and alcohol, and fatty foods rich in saturated fats). In that regard, food-level substitution analyses in Canadians support this assumption for saturated fats <span class="citation" data-cites="harrison2021 harrison2022">[<a href="#ref-harrison2021" role="doc-biblioref">38</a>,<a href="#ref-harrison2022" role="doc-biblioref">39</a>]</span>.</p>
<div style="page-break-after: always;"></div>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| label: tbl-dietint</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #| tbl-cap: "Diet intervention"</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                Generate table presenting interventions                  #</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     CFG reformulation intervention values      #</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>pfab_int <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>pfpb_int <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>milk_int <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#             Full intervention data             #</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>data_dietint <span class="ot">&lt;-</span> </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="fu">file.path</span>(dir_results,<span class="st">"Table_data.xlsx"</span>),</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sheet =</span> <span class="st">"dietint"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicate values that are unchanged by intervention</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Animal-based protein intervention</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">pfab =</span> <span class="fu">ifelse</span>(int<span class="sc">&gt;</span><span class="dv">2</span>, pfab<span class="sc">+</span>pfab_int, pfab),</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Plant-based protein intervention</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">pfpb =</span> <span class="fu">ifelse</span>(int<span class="sc">&gt;</span><span class="dv">2</span>, pfpb<span class="sc">+</span>pfpb_int, pfpb),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Milk and pant beverages with sufficient protein</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">milk_plantbev =</span> <span class="fu">ifelse</span>(int<span class="sc">&gt;</span><span class="dv">2</span>, milk_plantbev<span class="sc">+</span>milk_int, milk_plantbev),</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="do">## add labels and common values</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">dietsuppl =</span> <span class="fu">ifelse</span>(int<span class="sc">&gt;</span><span class="dv">1</span>, <span class="st">"No change"</span>,dietsuppl),</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">exercise  =</span> <span class="fu">ifelse</span>(int<span class="sc">&gt;</span><span class="dv">1</span> <span class="sc">&amp;</span> int<span class="sc">!=</span><span class="dv">4</span>, <span class="st">"No change"</span>,exercise),</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"otherfoods"</span>, <span class="st">"otherbev"</span>, <span class="st">"rg"</span>),</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>           <span class="cf">function</span>(x) <span class="fu">ifelse</span>(int<span class="sc">&gt;</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(x),<span class="st">"Minimum"</span>,x))</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># add factor for clean labels</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>data_dietint<span class="sc">$</span>drig_f <span class="ot">&lt;-</span> </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(data_dietint<span class="sc">$</span>drig,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">15</span>),</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"All, 51y+"</span>,</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Males, 67-70 y"</span>,</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Females, 67-70 y"</span>,</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Males"</span>,</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Females"</span>))</span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>data_dietint<span class="sc">$</span>int_f <span class="ot">&lt;-</span> </span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(data_dietint<span class="sc">$</span>int,</span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"1. Control (no change)"</span>,</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices"</span>,</span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"3. Same as 2 + extra protein"</span>,</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"4. Same as 3 + physical activity"</span>))</span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Generate table                 #</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>tab_dietint <span class="ot">&lt;-</span> </span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>  data_dietint <span class="sc">|&gt;</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(int_f) <span class="sc">|&gt;</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_move_to_start</span>(<span class="at">columns=</span><span class="fu">c</span>(int_f,drig_f)) <span class="sc">|&gt;</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_move_to_end</span>(<span class="at">columns=</span><span class="fu">c</span>(exercise)) <span class="sc">|&gt;</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_hide</span>(<span class="at">columns =</span> <span class="fu">c</span>(drig,int)) <span class="sc">|&gt;</span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_spanner</span>(<span class="at">label=</span><span class="st">"Recommended foods, RA/day"</span>,</span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>                  <span class="at">columns =</span> <span class="fu">c</span>(vf,wg,pfpb,pfab, milk_plantbev, ufa)) <span class="sc">|&gt;</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_spanner</span>(<span class="at">label=</span><span class="st">"Foods and beverages not recommended, RA/day"</span>,</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>                  <span class="at">columns =</span> <span class="fu">c</span>(otherfoods, otherbev, rg)) <span class="sc">|&gt;</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_label</span>(</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">int    =</span> <span class="st">"Intervention"</span>,</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">drig_f =</span> <span class="st">"Sex"</span>,</span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">vf     =</span> <span class="st">"Vegetables &amp; fruits"</span>,</span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">wg     =</span> <span class="st">"Whole grains"</span>,</span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">pfpb   =</span> <span class="st">"Protein foods, plant-based"</span>,</span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">pfab   =</span> <span class="st">"Protein foods, animal-based"</span>,</span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">milk_plantbev =</span> <span class="st">"Milk &amp; Plant-based bev. with protein"</span>,</span>
<span id="cb5-79"><a href="#cb5-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">ufa    =</span> <span class="st">"Unsaturated oils &amp; fats"</span>,</span>
<span id="cb5-80"><a href="#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">dietsuppl =</span> <span class="st">"Dietary supplement"</span>,</span>
<span id="cb5-81"><a href="#cb5-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">otherfoods =</span> <span class="st">"Other foods"</span>,</span>
<span id="cb5-82"><a href="#cb5-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">otherbev =</span> <span class="st">"Sugary drinks, alcohol"</span>,</span>
<span id="cb5-83"><a href="#cb5-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">rg       =</span> <span class="st">"Non-whole grains"</span>,</span>
<span id="cb5-84"><a href="#cb5-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">exercise =</span> <span class="st">"Physical activity, minutes/day"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-85"><a href="#cb5-85" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">sub_missing</span>(<span class="at">missing_text =</span><span class="st">"-"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-86"><a href="#cb5-86" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(</span>
<span id="cb5-87"><a href="#cb5-87" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Hypothetical diet and exercise interventions emulated in the NuAge cohort study, by sex"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-88"><a href="#cb5-88" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb5-89"><a href="#cb5-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"The emulation of all hypothetical interventions will be implemented using a substitution approach in statistical models. In all models, one variable for 'total food intake' and one variable for 'total beverage intake' will be included, and foods not recommended will be left out from the models (i.e., {knitr::combine_words(notrecommended)}). CFG, Canada's Food Guide; NuAge, Quebec Longitudinal Study on Nutrition and Successful Aging; RA, reference amount; y, year"</span>),</span>
<span id="cb5-90"><a href="#cb5-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_title</span>(<span class="st">"title"</span>)</span>
<span id="cb5-91"><a href="#cb5-91" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-92"><a href="#cb5-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicate what are 'control' values</span></span>
<span id="cb5-93"><a href="#cb5-93" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb5-94"><a href="#cb5-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Values are averages observed at baseline in the NuAge cohort. In other words, values are the observed intakes for the food categories or amount of physical activity when no change is applied."</span>,</span>
<span id="cb5-95"><a href="#cb5-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_row_groups</span>(<span class="at">groups =</span> <span class="fu">attributes</span>(data_dietint<span class="sc">$</span>int_f)<span class="sc">$</span>levels[<span class="dv">1</span>])</span>
<span id="cb5-96"><a href="#cb5-96" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-97"><a href="#cb5-97" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicate what are 'CFG adherence' values</span></span>
<span id="cb5-98"><a href="#cb5-98" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb5-99"><a href="#cb5-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Values are derived from Health Canada's simulated composite diets of adults 71 years or older. Participants would be expected to meet these targets for each food categories. The specific food choices within these categories would be at the participants' discretion. Values for vegetables and fruits, whole-grain foods and plant-based protein foods were truncated to correspond, at most, to the 90th percentile of the distribution of usual intakes among Canadians aged 65 years in 2015."</span>,</span>
<span id="cb5-100"><a href="#cb5-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_row_groups</span>(<span class="at">groups =</span> <span class="fu">attributes</span>(data_dietint<span class="sc">$</span>int_f)<span class="sc">$</span>levels[<span class="dv">2</span>])</span>
<span id="cb5-101"><a href="#cb5-101" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-102"><a href="#cb5-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicate what is the extra protein treatment</span></span>
<span id="cb5-103"><a href="#cb5-103" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb5-104"><a href="#cb5-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"Extra protein foods were added as follows: +{pfpb_int} RA of plant-based protein foods (e.g., {pfpb_int*50} grams of nuts), +{pfab_int} RA of animal-based protein foods (e.g., {pfab_int*100} grams of cooked unprocessed red meat, fish or poultry or {round(pfab_int*100/50)} small eggs), +{milk_int} RA of milk or plant-based beverage with protein (e.g., {milk_int*250} ml of milk or plant-based beverages with sufficient protein)."</span>),</span>
<span id="cb5-105"><a href="#cb5-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_row_groups</span>(<span class="at">groups =</span> <span class="fu">attributes</span>(data_dietint<span class="sc">$</span>int_f)<span class="sc">$</span>levels[<span class="dv">3</span>])</span>
<span id="cb5-106"><a href="#cb5-106" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-107"><a href="#cb5-107" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicate meaning of dietary supplement column</span></span>
<span id="cb5-108"><a href="#cb5-108" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb5-109"><a href="#cb5-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Dietary supplements were not intervened on, but were nonetheless excluded from foods and beverages not recommended to avoid being considered in the substitution. In other words, participants would be not be instructed to modify their dietary supplements in the hypothetical trial."</span>,</span>
<span id="cb5-110"><a href="#cb5-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="at">columns=</span><span class="st">"dietsuppl"</span>)</span>
<span id="cb5-111"><a href="#cb5-111" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-112"><a href="#cb5-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Describe exercise</span></span>
<span id="cb5-113"><a href="#cb5-113" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb5-114"><a href="#cb5-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Physical activity corresponds to aerobic exercise of moderate intensity or higher (Bauer et al. 2013)."</span>,</span>
<span id="cb5-115"><a href="#cb5-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_column_labels</span>(<span class="at">columns=</span><span class="st">"exercise"</span>)</span>
<span id="cb5-116"><a href="#cb5-116" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb5-117"><a href="#cb5-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Indicate what are 'Minimum' values</span></span>
<span id="cb5-118"><a href="#cb5-118" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_footnote</span>(</span>
<span id="cb5-119"><a href="#cb5-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">footnote =</span> <span class="st">"Minimum indicates that consumption would be set at the smallest amount permitting a concomitant increase in recommended foods to meet Canada's Food Guide targets. Portions for foods not recommended may vary on an individual basis."</span>,</span>
<span id="cb5-120"><a href="#cb5-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_spanners</span>(<span class="at">spanners=</span><span class="st">"Foods and beverages not recommended, RA/day"</span>)</span>
<span id="cb5-121"><a href="#cb5-121" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cells_body(columns=c("otherfoods":"rg"),rows=3:nrow(data_dietint) )</span></span>
<span id="cb5-122"><a href="#cb5-122" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb5-123"><a href="#cb5-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-124"><a href="#cb5-124" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-125"><a href="#cb5-125" aria-hidden="true" tabindex="-1"></a><span class="co">#                  Print table                   #</span></span>
<span id="cb5-126"><a href="#cb5-126" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb5-127"><a href="#cb5-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-128"><a href="#cb5-128" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(print_table<span class="sc">==</span><span class="st">"Y"</span>) {</span>
<span id="cb5-129"><a href="#cb5-129" aria-hidden="true" tabindex="-1"></a>  tab_dietint <span class="sc">|&gt;</span> <span class="fu">gtstyle</span>()</span>
<span id="cb5-130"><a href="#cb5-130" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="kousgaxwva" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kousgaxwva table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kousgaxwva thead, #kousgaxwva tbody, #kousgaxwva tfoot, #kousgaxwva tr, #kousgaxwva td, #kousgaxwva th {
  border-style: none;
}

#kousgaxwva p {
  margin: 0;
  padding: 0;
}

#kousgaxwva .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kousgaxwva .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kousgaxwva .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kousgaxwva .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kousgaxwva .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kousgaxwva .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kousgaxwva .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kousgaxwva .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kousgaxwva .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kousgaxwva .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kousgaxwva .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kousgaxwva .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kousgaxwva .gt_spanner_row {
  border-bottom-style: hidden;
}

#kousgaxwva .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kousgaxwva .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kousgaxwva .gt_from_md > :first-child {
  margin-top: 0;
}

#kousgaxwva .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kousgaxwva .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kousgaxwva .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kousgaxwva .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kousgaxwva .gt_row_group_first td {
  border-top-width: 2px;
}

#kousgaxwva .gt_row_group_first th {
  border-top-width: 2px;
}

#kousgaxwva .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kousgaxwva .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kousgaxwva .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kousgaxwva .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kousgaxwva .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kousgaxwva .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kousgaxwva .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kousgaxwva .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kousgaxwva .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kousgaxwva .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kousgaxwva .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kousgaxwva .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kousgaxwva .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kousgaxwva .gt_left {
  text-align: left;
}

#kousgaxwva .gt_center {
  text-align: center;
}

#kousgaxwva .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kousgaxwva .gt_font_normal {
  font-weight: normal;
}

#kousgaxwva .gt_font_bold {
  font-weight: bold;
}

#kousgaxwva .gt_font_italic {
  font-style: italic;
}

#kousgaxwva .gt_super {
  font-size: 65%;
}

#kousgaxwva .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kousgaxwva .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kousgaxwva .gt_indent_1 {
  text-indent: 5px;
}

#kousgaxwva .gt_indent_2 {
  text-indent: 10px;
}

#kousgaxwva .gt_indent_3 {
  text-indent: 15px;
}

#kousgaxwva .gt_indent_4 {
  text-indent: 20px;
}

#kousgaxwva .gt_indent_5 {
  text-indent: 25px;
}

#kousgaxwva .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kousgaxwva div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header gt_heading">
<th colspan="12" class="gt_heading gt_title gt_font_normal gt_bottom_border">Hypothetical diet and exercise interventions emulated in the NuAge cohort study, by sex<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
<tr class="odd gt_col_headings gt_spanner_row">
<th rowspan="2" id="drig_f" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">Sex</th>
<th colspan="6" id="Recommended foods, RA/day" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Recommended foods, RA/day
</div></th>
<th rowspan="2" id="dietsuppl" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Dietary supplement<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span></th>
<th colspan="3" id="Foods and beverages not recommended, RA/day" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Foods and beverages not recommended, RA/day<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span>
</div></th>
<th rowspan="2" id="exercise" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Physical activity, minutes/day<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span></th>
</tr>
<tr class="header gt_col_headings">
<th id="vf" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Vegetables &amp; fruits</th>
<th id="wg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Whole grains</th>
<th id="pfpb" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Protein foods, plant-based</th>
<th id="pfab" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Protein foods, animal-based</th>
<th id="milk_plantbev" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Milk &amp; Plant-based bev. with protein</th>
<th id="ufa" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Unsaturated oils &amp; fats</th>
<th id="otherfoods" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Other foods</th>
<th id="otherbev" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Sugary drinks, alcohol</th>
<th id="rg" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Non-whole grains</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="12" id="1. Control (no change)<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;&quot;><sup>5</sup></span>" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-weight: bold" scope="colgroup">1. Control (no change)<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span></td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="1. Control (no change)  drig_f">Males</td>
<td class="gt_row gt_right" headers="1. Control (no change)  vf">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  wg">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  pfpb">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  pfab">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  milk_plantbev">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  ufa">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  dietsuppl">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  otherfoods">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  otherbev">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  rg">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  exercise">-</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="1. Control (no change)  drig_f">Females</td>
<td class="gt_row gt_right" headers="1. Control (no change)  vf">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  wg">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  pfpb">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  pfab">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  milk_plantbev">-</td>
<td class="gt_row gt_right" headers="1. Control (no change)  ufa">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  dietsuppl">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  otherfoods">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  otherbev">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  rg">-</td>
<td class="gt_row gt_left" headers="1. Control (no change)  exercise">-</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="12" id="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;&quot;><sup>6</sup></span>" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-weight: bold" scope="colgroup">2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span></td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  drig_f">Males</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  vf">6</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  wg">1.5</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  pfpb">1.0</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  pfab">2.0</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  milk_plantbev">1.0</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  ufa">1</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  dietsuppl">No change</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  otherfoods">Minimum</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  otherbev">Minimum</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  rg">Minimum</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  exercise">No change</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  drig_f">Females</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  vf">5</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  wg">1.5</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  pfpb">0.8</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  pfab">1.5</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  milk_plantbev">1.0</td>
<td class="gt_row gt_right" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  ufa">1</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  dietsuppl">No change</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  otherfoods">Minimum</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  otherbev">Minimum</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  rg">Minimum</td>
<td class="gt_row gt_left" headers="2. Adhering to Canada's Food Guide 2019 recommendations on healthy food choices  exercise">No change</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="12" id="3. Same as 2 + extra protein<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;&quot;><sup>7</sup></span>" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-weight: bold" scope="colgroup">3. Same as 2 + extra protein<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span></td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_center" headers="3. Same as 2 + extra protein  drig_f">Males</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  vf">6</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  wg">1.5</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  pfpb">1.5</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  pfab">3.5</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  milk_plantbev">1.5</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  ufa">1</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  dietsuppl">No change</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  otherfoods">Minimum</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  otherbev">Minimum</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  rg">Minimum</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  exercise">No change</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="3. Same as 2 + extra protein  drig_f">Females</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  vf">5</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  wg">1.5</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  pfpb">1.3</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  pfab">3.0</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  milk_plantbev">1.5</td>
<td class="gt_row gt_right" headers="3. Same as 2 + extra protein  ufa">1</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  dietsuppl">No change</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  otherfoods">Minimum</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  otherbev">Minimum</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  rg">Minimum</td>
<td class="gt_row gt_left" headers="3. Same as 2 + extra protein  exercise">No change</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="12" id="4. Same as 3 + physical activity" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-weight: bold" scope="colgroup">4. Same as 3 + physical activity</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_center" headers="4. Same as 3 + physical activity  drig_f">Males</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  vf">6</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  wg">1.5</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  pfpb">1.5</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  pfab">3.5</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  milk_plantbev">1.5</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  ufa">1</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  dietsuppl">No change</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  otherfoods">Minimum</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  otherbev">Minimum</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  rg">Minimum</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  exercise">30 or more</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="4. Same as 3 + physical activity  drig_f">Females</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  vf">5</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  wg">1.5</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  pfpb">1.3</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  pfab">3.0</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  milk_plantbev">1.5</td>
<td class="gt_row gt_right" headers="4. Same as 3 + physical activity  ufa">1</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  dietsuppl">No change</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  otherfoods">Minimum</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  otherbev">Minimum</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  rg">Minimum</td>
<td class="gt_row gt_left" headers="4. Same as 3 + physical activity  exercise">30 or more</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="12" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> The emulation of all hypothetical interventions will be implemented using a substitution approach in statistical models. In all models, one variable for 'total food intake' and one variable for 'total beverage intake' will be included, and foods not recommended will be left out from the models (i.e., non-whole grain foods, other low nutritive value foods, juice, sugary drinks and alcohol, and fatty foods rich in saturated fats). CFG, Canada's Food Guide; NuAge, Quebec Longitudinal Study on Nutrition and Successful Aging; RA, reference amount; y, year</td>
</tr>
<tr class="even">
<td colspan="12" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>2</sup></span> Minimum indicates that consumption would be set at the smallest amount permitting a concomitant increase in recommended foods to meet Canada's Food Guide targets. Portions for foods not recommended may vary on an individual basis.</td>
</tr>
<tr class="odd">
<td colspan="12" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>3</sup></span> Dietary supplements were not intervened on, but were nonetheless excluded from foods and beverages not recommended to avoid being considered in the substitution. In other words, participants would be not be instructed to modify their dietary supplements in the hypothetical trial.</td>
</tr>
<tr class="even">
<td colspan="12" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>4</sup></span> Physical activity corresponds to aerobic exercise of moderate intensity or higher (Bauer et al. 2013).</td>
</tr>
<tr class="odd">
<td colspan="12" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>5</sup></span> Values are averages observed at baseline in the NuAge cohort. In other words, values are the observed intakes for the food categories or amount of physical activity when no change is applied.</td>
</tr>
<tr class="even">
<td colspan="12" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>6</sup></span> Values are derived from Health Canada's simulated composite diets of adults 71 years or older. Participants would be expected to meet these targets for each food categories. The specific food choices within these categories would be at the participants' discretion. Values for vegetables and fruits, whole-grain foods and plant-based protein foods were truncated to correspond, at most, to the 90th percentile of the distribution of usual intakes among Canadians aged 65 years in 2015.</td>
</tr>
<tr class="odd">
<td colspan="12" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>7</sup></span> Extra protein foods were added as follows: +0.5 RA of plant-based protein foods (e.g., 25 grams of nuts), +1.5 RA of animal-based protein foods (e.g., 150 grams of cooked unprocessed red meat, fish or poultry or 3 small eggs), +0.5 RA of milk or plant-based beverage with protein (e.g., 125 ml of milk or plant-based beverages with sufficient protein).</td>
</tr>
</tfoot>

</table>

</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Save table                   #</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>gt<span class="sc">::</span><span class="fu">gtsave</span>(tab_dietint,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">filename =</span> <span class="fu">file.path</span>(dir_tab,<span class="st">"tab_dietint.docx"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The “additional protein” intervention consists of increasing the intake of both animal-based and plant-based protein foods by 1.5 and 0.5 RA per day, respectively, as well as milk and plant-based beverages with sufficient protein by 0.5 RA per day. In terms of amount of food, this corresponds to adding 150 grams of cooked unprocessed red meat, fish or poultry or 3 small eggs, 25 grams of nuts and seeds and 125 ml of milk or plant-based beverages with sufficient protein, while proportionally decreasing the intake of foods not recommended. In a previous RCT <span class="citation" data-cites="daly2014">[<a href="#ref-daly2014" role="doc-biblioref">40</a>]</span>, older women aged 60 to 90 years were able to consume an additional 160 grams of cooked lean red meat without substitution, hereby supporting the feasibility of the protein intervention in the present hypothetical study.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="assignment" class="level3">
<h3 class="anchored" data-anchor-id="assignment">Assignment</h3>
<p>Random allocation (randomization) will be emulated by adjusting for dietary intakes in the year prior to the intervention, as well as adjusting for covariates at the start of the study. Covariates were identified using the causal diagrams depicted in <a href="#fig-dag-rand" class="quarto-xref">Figure&nbsp;1</a> based on background knowledge of the relationship between the hypothetical lifestyle intervention and outcomes.</p>
<p>Dietary components that are the foundation for healthy eating in CFG include intakes of vegetables and fruits, whole grains, protein foods (plant- and animal-based protein foods, milk and plant-based beverages with protein), unsaturated oils and fats <span class="citation" data-cites="healthcanada2019">[<a href="#ref-healthcanada2019" role="doc-biblioref">1</a>]</span>.</p>
<p>Covariates include age at baseline, biological sex, region, education, living alone, smoking and drinking (alcohol) habits, major chronic diseases (i.e., hypertension, diabetes, cancer, heart disease), number of medications, supplement use (e.g., vitamins and minerals), living alone, and height and weight.</p>
<ul>
<li><span class="math inline">\(Z\)</span>, baseline covariates: age, sex, region, education, history of smoking, height, former cancer.</li>
<li><span class="math inline">\(P\)</span>, prior exposure (i.e., exposure of time-varying intervention prior to baseline): dietary habits before baseline</li>
<li><span class="math inline">\(L\)</span>, (time-varying) covariates: weight, number of medications, supplement use, living alone, major chronic diseases (hypertension, diabetes, cancer, heart disease), smoking and alcohol habits</li>
<li><span class="math inline">\(X\)</span>, (time-varying) treatment: diet and physical activity habits</li>
<li><span class="math inline">\(Y\)</span>, end of follow-up outcome: muscle health, general health, cognitive health.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           Input Dagitty information            #</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Dagitty frame</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>dag_rand_generic <span class="ot">&lt;-</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a> dagitty<span class="sc">::</span><span class="fu">dagitty</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="st">'dag {</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="st">bb="0,0,1,1"</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" [pos="0.100,0.300",Xdjusted="1"]</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="st">L0 [pos="0.250,0.500",Xdjusted="1"]</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="st">X0 [exposure,pos="0.300,0.300"]</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="st">Y [outcome,pos="0.527,0.300"]</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="st">Z [pos="0.100,0.400"]</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; L0</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; X0</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; Y [pos="0.260,0.400"]</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="st">L0 -&gt; X0</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="st">L0 -&gt; Y</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="st">X0 -&gt; Y</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="st">Z -&gt; L0</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="st">Z -&gt; X0</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="st">Z -&gt; Y</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to ggdag</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>dag_rand_generic <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">tidy_dagitty</span>(dag_rand_generic)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate second set of coordinates for edge-arc </span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>dag_rand_generic <span class="ot">&lt;-</span> </span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  dag_rand_generic <span class="sc">|&gt;</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="do">## create second set of coordinates for edge-arc</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x coordinates</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend_arc =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>     name<span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">&amp;</span> to <span class="sc">==</span><span class="st">"Y"</span> <span class="sc">~</span> xend ,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">.default =</span> <span class="cn">NA</span> </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y coordinates</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend_arc =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>      name<span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">&amp;</span> to <span class="sc">==</span><span class="st">"Y"</span> <span class="sc">~</span> yend ,</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="cn">NA</span> </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove straight edge for those flag with arc</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(xend_arc),xend,<span class="cn">NA</span>),</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(yend_arc),yend,<span class="cn">NA</span>),</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                   Generate panel A with confounding                     #</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a><span class="co">#              Labelling and colors              #</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Use default color to draw attention to the path of interests</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>default_colour <span class="ot">&lt;-</span> <span class="st">"black"</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>highlight_colour <span class="ot">&lt;-</span> <span class="st">"#a82203"</span> <span class="co"># MetBrewer::met.brewer("Juarez",n=1)</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Add colors</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>dag_rand_unadjust <span class="ot">&lt;-</span> </span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>  dag_rand_generic  <span class="sc">|&gt;</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_colour =</span> <span class="fu">ifelse</span>(name<span class="sc">!=</span><span class="st">"X0"</span>,highlight_colour,default_colour),</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_line =</span> <span class="st">"solid"</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>name_colour <span class="ot">&lt;-</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X0"</span> <span class="ot">=</span> default_colour,</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L0"</span> <span class="ot">=</span> highlight_colour,</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y"</span> <span class="ot">=</span> default_colour,</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P-1"</span> <span class="ot">=</span> highlight_colour, </span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Z"</span> <span class="ot">=</span> highlight_colour</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a><span class="co"># add nodes label for ggplot</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>dag_rand_unadjust_labels <span class="ot">&lt;-</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(dag_rand_unadjust) <span class="sc">|&gt;</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"X0"</span><span class="sc">~</span><span class="st">"X\u2080"</span>,</span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"L0"</span> <span class="sc">~</span> <span class="st">"L\u2080"</span>,</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"Y"</span>  <span class="sc">~</span> <span class="st">"Y"</span>,</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">~</span> <span class="st">"P\u208b\u2081"</span>,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"Z"</span> <span class="sc">~</span> <span class="st">"Z"</span>)</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(label)</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a><span class="co">#             Create DAG with ggplot             #</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>make_dag_rand_A <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">scale_node_size=</span><span class="dv">1</span>, <span class="at">text_size=</span><span class="dv">4</span>, <span class="at">default_node_size=</span><span class="dv">16</span>){</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note: text size default is 4</span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate node size as a factor x default</span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>  node_size <span class="ot">&lt;-</span> default_node_size <span class="sc">*</span> scale_node_size</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>fig_dag_rand_unadjust <span class="ot">&lt;-</span></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>  dag_rand_unadjust  <span class="sc">|&gt;</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x,</span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y,</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> xend,</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> yend</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> name),<span class="at">size =</span> node_size,<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="fu">aes</span>(<span class="at">edge_colour   =</span> name_colour,</span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>                     <span class="at">edge_linetype =</span> name_line)) <span class="sc">+</span></span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges_arc</span>(<span class="fu">aes</span>(<span class="at">xend         =</span> xend_arc,</span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yend          =</span> yend_arc,</span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>                        <span class="at">edge_colour   =</span> name_colour,</span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>                        <span class="at">edge_linetype =</span> name_line),<span class="at">curvature=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> name_colour) <span class="sc">+</span></span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>dag_rand_unadjust_labels), <span class="at">size=</span>text_size) <span class="sc">+</span></span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>()</span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(fig_dag_rand_unadjust)</span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-124"><a href="#cb7-124" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-125"><a href="#cb7-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-126"><a href="#cb7-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate figure for different layout</span></span>
<span id="cb7-127"><a href="#cb7-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-128"><a href="#cb7-128" aria-hidden="true" tabindex="-1"></a><span class="do">## normal version</span></span>
<span id="cb7-129"><a href="#cb7-129" aria-hidden="true" tabindex="-1"></a>fig_unadjust_normal <span class="ot">&lt;-</span> </span>
<span id="cb7-130"><a href="#cb7-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_dag_rand_A</span>(<span class="at">text_size=</span><span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb7-131"><a href="#cb7-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"**A.** Confounding at baseline"</span>) <span class="sc">+</span> </span>
<span id="cb7-132"><a href="#cb7-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>())</span>
<span id="cb7-133"><a href="#cb7-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-134"><a href="#cb7-134" aria-hidden="true" tabindex="-1"></a><span class="do">## JMIR format</span></span>
<span id="cb7-135"><a href="#cb7-135" aria-hidden="true" tabindex="-1"></a>fig_unadjust_jmir <span class="ot">&lt;-</span> </span>
<span id="cb7-136"><a href="#cb7-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_dag_rand_A</span>(<span class="at">scale_node_size=</span><span class="fl">0.5</span>, <span class="at">text_size=</span><span class="fl">3.5</span>) <span class="sc">+</span> </span>
<span id="cb7-137"><a href="#cb7-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"**A.** Confounding at baseline"</span>) <span class="sc">+</span> </span>
<span id="cb7-138"><a href="#cb7-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>(<span class="at">size=</span><span class="dv">10</span>))</span>
<span id="cb7-139"><a href="#cb7-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-140"><a href="#cb7-140" aria-hidden="true" tabindex="-1"></a><span class="do">## JMIR TOC figure</span></span>
<span id="cb7-141"><a href="#cb7-141" aria-hidden="true" tabindex="-1"></a>fig_dag_unadjust_jmir_toc <span class="ot">&lt;-</span> </span>
<span id="cb7-142"><a href="#cb7-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_dag_rand_A</span>(<span class="at">scale_node_size=</span><span class="fl">0.5</span>, <span class="at">text_size=</span><span class="fl">3.5</span>) <span class="sc">+</span> </span>
<span id="cb7-143"><a href="#cb7-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-144"><a href="#cb7-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb7-145"><a href="#cb7-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color=</span><span class="cn">NA</span>), </span>
<span id="cb7-146"><a href="#cb7-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">color=</span><span class="cn">NA</span>)</span>
<span id="cb7-147"><a href="#cb7-147" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-148"><a href="#cb7-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-149"><a href="#cb7-149" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-150"><a href="#cb7-150" aria-hidden="true" tabindex="-1"></a><span class="co">#                  Generate panel B without confounding                   #</span></span>
<span id="cb7-151"><a href="#cb7-151" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-152"><a href="#cb7-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-153"><a href="#cb7-153" aria-hidden="true" tabindex="-1"></a><span class="co">#note: starts based on 'dag_rand_generic' created above, but colors and path updated to highlight adjustment</span></span>
<span id="cb7-154"><a href="#cb7-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-155"><a href="#cb7-155" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-156"><a href="#cb7-156" aria-hidden="true" tabindex="-1"></a><span class="co">#              Labelling and colors              #</span></span>
<span id="cb7-157"><a href="#cb7-157" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-158"><a href="#cb7-158" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-159"><a href="#cb7-159" aria-hidden="true" tabindex="-1"></a><span class="co"># Use default color to draw attention to the path of interests</span></span>
<span id="cb7-160"><a href="#cb7-160" aria-hidden="true" tabindex="-1"></a>default_colour <span class="ot">&lt;-</span> <span class="st">"black"</span></span>
<span id="cb7-161"><a href="#cb7-161" aria-hidden="true" tabindex="-1"></a>highlight_colour <span class="ot">&lt;-</span> <span class="st">"darkgray"</span> </span>
<span id="cb7-162"><a href="#cb7-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-163"><a href="#cb7-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Add colors</span></span>
<span id="cb7-164"><a href="#cb7-164" aria-hidden="true" tabindex="-1"></a>dag_rand_adjust <span class="ot">&lt;-</span> </span>
<span id="cb7-165"><a href="#cb7-165" aria-hidden="true" tabindex="-1"></a>  dag_rand_generic  <span class="sc">|&gt;</span></span>
<span id="cb7-166"><a href="#cb7-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-167"><a href="#cb7-167" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Color of point/edge/lines</span></span>
<span id="cb7-168"><a href="#cb7-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_colour =</span> highlight_colour,</span>
<span id="cb7-169"><a href="#cb7-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_colour =</span> <span class="fu">ifelse</span>(name<span class="sc">==</span><span class="st">"X0"</span> <span class="sc">&amp;</span> to<span class="sc">==</span><span class="st">"Y"</span>, default_colour, name_colour),</span>
<span id="cb7-170"><a href="#cb7-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">name_line =</span> <span class="st">"solid"</span></span>
<span id="cb7-171"><a href="#cb7-171" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">|&gt;</span></span>
<span id="cb7-172"><a href="#cb7-172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove confounding as estimated in a pseudo-population</span></span>
<span id="cb7-173"><a href="#cb7-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(to<span class="sc">==</span><span class="st">"X0"</span> <span class="sc">&amp;</span> name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"P-1"</span>, <span class="st">"Z"</span>, <span class="st">"L0"</span>)))</span>
<span id="cb7-174"><a href="#cb7-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-175"><a href="#cb7-175" aria-hidden="true" tabindex="-1"></a>name_colour <span class="ot">&lt;-</span></span>
<span id="cb7-176"><a href="#cb7-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb7-177"><a href="#cb7-177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"X0"</span> <span class="ot">=</span> default_colour,</span>
<span id="cb7-178"><a href="#cb7-178" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L0"</span> <span class="ot">=</span> highlight_colour,</span>
<span id="cb7-179"><a href="#cb7-179" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Y"</span> <span class="ot">=</span> default_colour,</span>
<span id="cb7-180"><a href="#cb7-180" aria-hidden="true" tabindex="-1"></a>    <span class="st">"P-1"</span> <span class="ot">=</span> highlight_colour, </span>
<span id="cb7-181"><a href="#cb7-181" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Z"</span> <span class="ot">=</span> highlight_colour</span>
<span id="cb7-182"><a href="#cb7-182" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-183"><a href="#cb7-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-184"><a href="#cb7-184" aria-hidden="true" tabindex="-1"></a><span class="co"># add nodes label for ggplot</span></span>
<span id="cb7-185"><a href="#cb7-185" aria-hidden="true" tabindex="-1"></a>dag_rand_adjust_labels <span class="ot">&lt;-</span></span>
<span id="cb7-186"><a href="#cb7-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(dag_rand_adjust) <span class="sc">|&gt;</span></span>
<span id="cb7-187"><a href="#cb7-187" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb7-188"><a href="#cb7-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-189"><a href="#cb7-189" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"X0"</span><span class="sc">~</span><span class="st">"X\u2080"</span>,</span>
<span id="cb7-190"><a href="#cb7-190" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"L0"</span> <span class="sc">~</span> <span class="st">"L\u2080"</span>,</span>
<span id="cb7-191"><a href="#cb7-191" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"Y"</span>  <span class="sc">~</span> <span class="st">"Y"</span>,</span>
<span id="cb7-192"><a href="#cb7-192" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">~</span> <span class="st">"P\u208b\u2081"</span>,</span>
<span id="cb7-193"><a href="#cb7-193" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"Z"</span> <span class="sc">~</span> <span class="st">"Z"</span>)</span>
<span id="cb7-194"><a href="#cb7-194" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb7-195"><a href="#cb7-195" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(label)</span>
<span id="cb7-196"><a href="#cb7-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-197"><a href="#cb7-197" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-198"><a href="#cb7-198" aria-hidden="true" tabindex="-1"></a><span class="co">#             Create DAG with ggplot             #</span></span>
<span id="cb7-199"><a href="#cb7-199" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-200"><a href="#cb7-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-201"><a href="#cb7-201" aria-hidden="true" tabindex="-1"></a>make_dag_rand_B <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">scale_node_size=</span><span class="dv">1</span>, <span class="at">text_size=</span><span class="dv">4</span>, <span class="at">default_node_size=</span><span class="dv">16</span>){</span>
<span id="cb7-202"><a href="#cb7-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-203"><a href="#cb7-203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate node size as a factor x default</span></span>
<span id="cb7-204"><a href="#cb7-204" aria-hidden="true" tabindex="-1"></a>  node_size <span class="ot">&lt;-</span> default_node_size <span class="sc">*</span> scale_node_size</span>
<span id="cb7-205"><a href="#cb7-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-206"><a href="#cb7-206" aria-hidden="true" tabindex="-1"></a>fig_dag_rand_adjust <span class="ot">&lt;-</span></span>
<span id="cb7-207"><a href="#cb7-207" aria-hidden="true" tabindex="-1"></a>  dag_rand_adjust  <span class="sc">|&gt;</span></span>
<span id="cb7-208"><a href="#cb7-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb7-209"><a href="#cb7-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x,</span>
<span id="cb7-210"><a href="#cb7-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y,</span>
<span id="cb7-211"><a href="#cb7-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> xend,</span>
<span id="cb7-212"><a href="#cb7-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> yend</span>
<span id="cb7-213"><a href="#cb7-213" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb7-214"><a href="#cb7-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> name),<span class="at">size =</span> node_size,<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-215"><a href="#cb7-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="fu">aes</span>(<span class="at">edge_colour   =</span> name_colour,</span>
<span id="cb7-216"><a href="#cb7-216" aria-hidden="true" tabindex="-1"></a>                     <span class="at">edge_linetype =</span> name_line)) <span class="sc">+</span></span>
<span id="cb7-217"><a href="#cb7-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges_arc</span>(<span class="fu">aes</span>(<span class="at">xend         =</span> xend_arc,</span>
<span id="cb7-218"><a href="#cb7-218" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yend          =</span> yend_arc,</span>
<span id="cb7-219"><a href="#cb7-219" aria-hidden="true" tabindex="-1"></a>                        <span class="at">edge_colour   =</span> name_colour,</span>
<span id="cb7-220"><a href="#cb7-220" aria-hidden="true" tabindex="-1"></a>                        <span class="at">edge_linetype =</span> name_line),<span class="at">curvature=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb7-221"><a href="#cb7-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> name_colour) <span class="sc">+</span></span>
<span id="cb7-222"><a href="#cb7-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>dag_rand_adjust_labels), <span class="at">size=</span>text_size) <span class="sc">+</span></span>
<span id="cb7-223"><a href="#cb7-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>()</span>
<span id="cb7-224"><a href="#cb7-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-225"><a href="#cb7-225" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(fig_dag_rand_adjust)</span>
<span id="cb7-226"><a href="#cb7-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-227"><a href="#cb7-227" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-228"><a href="#cb7-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-229"><a href="#cb7-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate figure for different layout</span></span>
<span id="cb7-230"><a href="#cb7-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-231"><a href="#cb7-231" aria-hidden="true" tabindex="-1"></a><span class="do">## normal version</span></span>
<span id="cb7-232"><a href="#cb7-232" aria-hidden="true" tabindex="-1"></a>fig_adjust_normal <span class="ot">&lt;-</span> </span>
<span id="cb7-233"><a href="#cb7-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_dag_rand_B</span>(<span class="at">text_size=</span><span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb7-234"><a href="#cb7-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"**B.** Successful emulation of randomization"</span>) <span class="sc">+</span></span>
<span id="cb7-235"><a href="#cb7-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>())</span>
<span id="cb7-236"><a href="#cb7-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-237"><a href="#cb7-237" aria-hidden="true" tabindex="-1"></a><span class="do">## JMIR format</span></span>
<span id="cb7-238"><a href="#cb7-238" aria-hidden="true" tabindex="-1"></a>fig_adjust_jmir <span class="ot">&lt;-</span> </span>
<span id="cb7-239"><a href="#cb7-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_dag_rand_B</span>(<span class="at">scale_node_size=</span><span class="fl">0.5</span>, <span class="at">text_size=</span><span class="fl">3.5</span>) <span class="sc">+</span> </span>
<span id="cb7-240"><a href="#cb7-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"**B.** Successful emulation of randomization"</span>) <span class="sc">+</span></span>
<span id="cb7-241"><a href="#cb7-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> ggtext<span class="sc">::</span><span class="fu">element_markdown</span>(<span class="at">size=</span><span class="dv">10</span>))</span>
<span id="cb7-242"><a href="#cb7-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-243"><a href="#cb7-243" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-244"><a href="#cb7-244" aria-hidden="true" tabindex="-1"></a><span class="co">#                Append both DAG with/without confounding                 #</span></span>
<span id="cb7-245"><a href="#cb7-245" aria-hidden="true" tabindex="-1"></a><span class="co"># *********************************************************************** #</span></span>
<span id="cb7-246"><a href="#cb7-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-247"><a href="#cb7-247" aria-hidden="true" tabindex="-1"></a><span class="co"># note: done using patchwork library</span></span>
<span id="cb7-248"><a href="#cb7-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-249"><a href="#cb7-249" aria-hidden="true" tabindex="-1"></a>fig_dag_rand_normal <span class="ot">&lt;-</span> fig_unadjust_normal <span class="sc">/</span> fig_adjust_normal</span>
<span id="cb7-250"><a href="#cb7-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-251"><a href="#cb7-251" aria-hidden="true" tabindex="-1"></a>fig_dag_rand_jmir <span class="ot">&lt;-</span> fig_unadjust_jmir <span class="sc">/</span> fig_adjust_jmir</span>
<span id="cb7-252"><a href="#cb7-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-253"><a href="#cb7-253" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-254"><a href="#cb7-254" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-255"><a href="#cb7-255" aria-hidden="true" tabindex="-1"></a><span class="co">#                Save as png/pdf                 #</span></span>
<span id="cb7-256"><a href="#cb7-256" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-257"><a href="#cb7-257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-258"><a href="#cb7-258" aria-hidden="true" tabindex="-1"></a><span class="co"># Normal version, pdf and png</span></span>
<span id="cb7-259"><a href="#cb7-259" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_rand.pdf"</span>),</span>
<span id="cb7-260"><a href="#cb7-260" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_rand_normal, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">8</span>,<span class="at">height=</span><span class="dv">8</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="dv">1</span>,<span class="at">device =</span> cairo_pdf)</span>
<span id="cb7-261"><a href="#cb7-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-262"><a href="#cb7-262" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_rand.png"</span>),</span>
<span id="cb7-263"><a href="#cb7-263" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_rand_normal, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">8</span>,<span class="at">height=</span><span class="dv">8</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="dv">1</span>)</span>
<span id="cb7-264"><a href="#cb7-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-265"><a href="#cb7-265" aria-hidden="true" tabindex="-1"></a><span class="co"># JMIR scaling (max. 1200x1200)</span></span>
<span id="cb7-266"><a href="#cb7-266" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_rand_jmir.png"</span>),</span>
<span id="cb7-267"><a href="#cb7-267" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_rand_jmir, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">1200</span>,<span class="at">height=</span><span class="dv">1200</span>, <span class="at">units=</span><span class="st">"px"</span>,<span class="at">scale=</span><span class="dv">1</span>)</span>
<span id="cb7-268"><a href="#cb7-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-269"><a href="#cb7-269" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_rand_jmir.pdf"</span>),</span>
<span id="cb7-270"><a href="#cb7-270" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_rand_jmir, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">1200</span>,<span class="at">height=</span><span class="dv">1200</span>, <span class="at">units=</span><span class="st">"px"</span>,<span class="at">scale=</span><span class="dv">1</span>, <span class="at">device =</span> cairo_pdf)</span>
<span id="cb7-271"><a href="#cb7-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-272"><a href="#cb7-272" aria-hidden="true" tabindex="-1"></a><span class="co"># JMIR scaling, for TOC (max. 1200x900)</span></span>
<span id="cb7-273"><a href="#cb7-273" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_unadjust_jmir_toc.png"</span>),</span>
<span id="cb7-274"><a href="#cb7-274" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_unadjust_jmir_toc, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">1200</span>,<span class="at">height=</span><span class="dv">800</span>, <span class="at">units=</span><span class="st">"px"</span>,<span class="at">scale=</span><span class="dv">1</span>)</span>
<span id="cb7-275"><a href="#cb7-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-276"><a href="#cb7-276" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-277"><a href="#cb7-277" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-278"><a href="#cb7-278" aria-hidden="true" tabindex="-1"></a><span class="co">#              Load rendered figure              #</span></span>
<span id="cb7-279"><a href="#cb7-279" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb7-280"><a href="#cb7-280" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-281"><a href="#cb7-281" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_rand.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dag-rand" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-rand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript/figures/fig_dag_rand.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-rand-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Causal directed acyclic graph (DAG) depicting confounding (A) and successful emulation of randomization using g methods (B) at baseline between the intervention strategy (X) and outcome (Y). Baseline covariates (both time-invariant [Z] and time-varying [L]) as well as prior diet and physical activity habits (P) must be considered to emulate randomization. The successful emulation of randomization of the lifestyle intervention strategy requires no unmeasured confounders and no residual confounding. Time-varying treatment and covariates are not shown in this DAG to focus on randomization emulation.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Contrary to dietary habits, data on physical activity habits before baseline were not collected in the NuAge study. In this case, the potential effect of prior physical activity habits will not be accounted for in the models that aim at emulating the sustained physical activity intervention strategy. For the models emulating the sustained diet intervention strategy only, physical activity habits during the study will be used as covariate, hence mitigating the confounding of prior physical activity, at least to some extent.</p>
<p>A successful emulation of randomization requires that there is no unmeasured confounding. However, this is never guaranteed with observational data. Thus, we emphasize our assumptions that 1) the causal graph accurately depicts the relationship under study; and 2) the covariates included are a sufficient set of covariates to address confounding.</p>
</section>
<section id="outcomes" class="level3">
<h3 class="anchored" data-anchor-id="outcomes">Outcomes</h3>
<p>The primary outcomes will be the mean end of follow-up values for muscle strength (i.e., handgrip using vigorimeter, elbow flexor, knee extensor) and physical function (i.e., normal and fast walking, “timed up-and-go”). Outcome values were measured according to standardized protocol in NuAge <span class="citation" data-cites="gaudreau2007">[<a href="#ref-gaudreau2007" role="doc-biblioref">25</a>]</span>.</p>
<p>For secondary outcomes, mean end of follow-up values for a set of relevant variables will be considered by domains:</p>
<ul>
<li><strong>General health</strong>: waist circumference, blood pressure (systolic, diastolic), blood glucose, estimated glomerular filtration rate;</li>
<li><strong>Cognition</strong>: the modified Mini-Mental State Examination (3MS) score.</li>
</ul>
</section>
<section id="time-zero-and-follow-up" class="level3">
<h3 class="anchored" data-anchor-id="time-zero-and-follow-up">Time Zero and Follow-up</h3>
<p>In the target trial of a sustained lifestyle intervention, participants would be met at baseline and then regularly to ensure that diet and physical activity habits are consistent with the intervention assigned by the random allocation. The hypothetical diet and physical activity intervention would be assigned and initiated at baseline. In the emulation, annual follow-ups with comprehensive diet, physical activity and covariate data collection are available to emulate the hypothetical intervention. Hence, participants would be followed from study baseline (time 0; i.e., the time at which the intervention strategy would also be assigned and would begin), at each year (time 1 and 2) and until the end of the study (time 3). We also assume that the diet and physical activity habits measured at each follow-up time adequately reflect the habits during the full year.</p>
<p>The end of follow-up outcome measurements will be used to estimate the effect of the sustained lifestyle intervention strategy. Measures of dietary intakes and physical activity throughout the study (i.e., time 0 to time 3) will be used to emulate the sustained lifestyle intervention. Dietary intakes in the year prior to the intervention will be estimated using the frequency questionnaire completed at study baseline (time 0). Missing covariate data at a given follow-up will be carried forward once, after which participants will be considered as having incomplete follow-up.</p>
</section>
<section id="causal-contrast" class="level3">
<h3 class="anchored" data-anchor-id="causal-contrast">Causal Contrast</h3>
<p>The estimand of interest in this study, the target causal effect of a sustained lifestyle intervention strategy, is</p>
<p><span id="eq-estimand"><span class="math display">\[
E(Y^{1,1,1,1} |C=0)-E(Y^{0,0,0,0} |C=0)
\tag{1}\]</span></span></p>
<p>that is, the expected value of a given health outcome <span class="math inline">\(Y\)</span> at the end of follow-up if all participants had increased their adherence to CFG recommendations on healthy food choices and physical activity, when applicable, at all four time points (<span class="math inline">\(X_k=1\)</span>, “always intervene”) vs., instead, if all participants had maintained their habitual diet and physical activity (<span class="math inline">\(X_k=0\)</span>, “never intervene”). The estimand (<a href="#eq-estimand" class="quarto-xref">Equation&nbsp;1</a>) also indicates that all participants completed the intervention (<span class="math inline">\(C=0\)</span>), i.e., in absence of incomplete follow-up.</p>
<p>The causal contrasts of interest are the observational analogues of “intention-to-treat” and “per protocol” <span class="citation" data-cites="hernan2016a">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>]</span>. Given the observational design, participants are not expected to have followed a treatment strategy unknown to them at the time of data collection. Therefore, the primary analysis will be the per protocol contrast of a sustained lifestyle intervention strategy. In the per protocol analysis, non-adherence to the hypothetical interventions can be accounted for. In the target trial, participants with a condition after baseline that would have prevented or limited participation in a hypothetical lifestyle intervention would be allowed to discontinue the intervention (e.g., lengthy hospitalization, prolonged bed rest, incident cancer). In the emulation, if such conditions occur in a sufficiently large number of participants, these participants will be “excused” from following the hypothetical intervention <span class="citation" data-cites="dickerman2019">[<a href="#ref-dickerman2019" role="doc-biblioref">23</a>]</span>. In other words, participants that would have been unable to pursue the study due to major events will not be considered as having incomplete follow-up if they attended the annual assessment. Allowing participants to discontinue adhering to the (hypothetical) intervention strategy mitigates confounding by the disease burden <span class="citation" data-cites="dickerman2019">[<a href="#ref-dickerman2019" role="doc-biblioref">23</a>]</span>.</p>
<p>The intention-to-treat analysis will be a secondary analysis of a hypothetical point intervention, e.g., dietary counselling at baseline only. Note that it will not be possible to conduct an intention-to-treat analysis identical to that of a controlled study where the interest is to estimate the effect of being <em>assigned</em> to an intervention <span class="citation" data-cites="hernan2016a">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>]</span>. However, it is possible to conduct an “observational analogue” of the intention-to-treat analysis. In the observational analogue, the intention-to-treat analysis aims to estimate the impact of a hypothetical intervention which adherence is measured at baseline only.</p>
</section>
<section id="statistical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="statistical-analysis">Statistical Analysis</h3>
<p>Stratification and multivariable regression (i.e., covariate adjustment) are conventional statistical approaches to address confounding in nutritional epidemiology. However, the conventional approaches are not adequate to estimate cumulative treatment effects (e.g., diet over time) in the presence of time-varying confounding (e.g., weight status over time) and treatment (e.g., prior diet) <span class="citation" data-cites="naimi2017 igelstrom2022">[<a href="#ref-naimi2017" role="doc-biblioref">41</a>,<a href="#ref-igelstrom2022" role="doc-biblioref">42</a>]</span>. In the present study, non-adherence to the hypothetical interventions and incomplete follow-up will be considered using (general) g methods for the per protocol analysis <span class="citation" data-cites="hernan2016a igelstrom2022">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>,<a href="#ref-igelstrom2022" role="doc-biblioref">42</a>]</span>. Among g methods, the parametric g-formula provides the most flexibility for analyses involving hypothetical dietary interventions, as used previously <span class="citation" data-cites="taubman2009 chiu2021 ibsen2023">[<a href="#ref-chiu2021" role="doc-biblioref">19</a>,<a href="#ref-ibsen2023" role="doc-biblioref">22</a>,<a href="#ref-taubman2009" role="doc-biblioref">43</a>]</span>. Briefly, in the context of an observational study, the parametric g formula, and its implementation into an R package <span class="citation" data-cites="mcgrath2020">[<a href="#ref-mcgrath2020" role="doc-biblioref">44</a>]</span>, uses parametric models to predict the joint-history of prior diet and physical activity habits (i.e., the hypothetical sustained intervention strategy) and confounding variables. For example, linear regression models are used to predict continuous covariates (e.g., body weight), while logistic regressions are used to predict binary or categorical variables (e.g., indicator variable for dietary supplement use). The per protocol causal contrast of hypothetical intervention presented in Table 2 is then emulated based on Monte Carlo simulated data generated using the g formula algorithm <span class="citation" data-cites="mcgrath2020">[<a href="#ref-mcgrath2020" role="doc-biblioref">44</a>]</span>. The parametric g formula correctly accounts for time-varying confounding in the presence of feedback between the intervention and the confounding variables, since confounding is addressed using standardization <span class="citation" data-cites="naimi2017 igelstrom2022">[<a href="#ref-naimi2017" role="doc-biblioref">41</a>,<a href="#ref-igelstrom2022" role="doc-biblioref">42</a>]</span>. Furthermore, standardization allows to estimate an average causal effect (i.e., marginal effect) consistent with the estimand of interest (Equation 1) rather than a conditional effect. In summary, a “threshold interventions” that depend on the reported dietary intakes or amount of physical activity <span class="citation" data-cites="taubman2009 young2014">[<a href="#ref-taubman2009" role="doc-biblioref">43</a>,<a href="#ref-young2014" role="doc-biblioref">45</a>]</span> and the parametric g-formula <span class="citation" data-cites="robins1986 mcgrath2020">[<a href="#ref-mcgrath2020" role="doc-biblioref">44</a>,<a href="#ref-robins1986" role="doc-biblioref">46</a>]</span> will be used to emulate the intervention of “consuming at least <span class="math inline">\(x\)</span> servings of food” and “doing at least <span class="math inline">\(x\)</span> minutes of light to vigorous physical activity”.</p>
<p><a href="#fig-dag-one-t" class="quarto-xref">Figure&nbsp;2</a> presents the causal DAG of the hypothesized relationship between a sustained lifestyle intervention strategy (<span class="math inline">\(X_0, X_1\)</span>) and an end of follow-up outcome <span class="math inline">\(Y\)</span>, for one follow-up after baseline (year 1). The model is limited to year 1 for clarity but the hypothesized causal structure extends to additional follow-ups. The exposure of interest <span class="math inline">\(X_k\)</span> is the joint and cumulative effect of a sustained diet and physical activity intervention strategy measured at baseline and at follow-ups.</p>
<p>In the context of this target trial emulation (<a href="#fig-dag-one-t" class="quarto-xref">Figure&nbsp;2</a>), <span class="math inline">\(P\)</span> includes dietary habits prior to the baseline assessment. <span class="math inline">\(P\)</span> can have an effect on baseline dietary habits (e.g., prior healthy habits increase likelihood of baseline healthy habits) and dietary habits throughout the target trial emulation (e.g., prior healthy habits increase likelihood of adhering to healthy habits). <span class="math inline">\(P\)</span> also influences baseline and time-varying confounding. Finally, given the long-term effect of chronic exposure, <span class="math inline">\(P\)</span> potentially also affect <span class="math inline">\(Y\)</span> directly.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#           Input Dagitty information            #</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># note: time-varying DAG with one follow-up</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Daggitty frame</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>dag_one_t <span class="ot">&lt;-</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a> dagitty<span class="sc">::</span><span class="fu">dagitty</span>(<span class="st">'dag {</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">bb="0,0,1,1"</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st">"Z" [pos="0.10,0.4"]</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" [pos="0.10,0.300",Xdjusted="1"]</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">L0 [pos="0.200,0.500",Xdjusted="1"]</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="st">L1 [pos="0.400,0.500",Xdjusted="1"]</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="st">X0 [exposure,pos="0.300,0.300"]</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="st">X1 [exposure,pos="0.500,0.300"]</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="st">Y [outcome,pos="0.700,0.300"]</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; L0</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; L1</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; X0</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; X1 [pos="0.240,0.400"]</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="st">"P-1" -&gt; Y [pos="0.260,0.500"]</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="st">L0 -&gt; L1</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">L0 -&gt; X0</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">L0 -&gt; X1</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="st">L0 -&gt; Y</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="st">L1 -&gt; X1</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="st">L1 -&gt; Y</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="st">X0 -&gt; L1</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="st">X0 -&gt; X1</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="st">X1 -&gt; Y</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">}'</span>)</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform to ggdag</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>dag_one_t <span class="ot">&lt;-</span> ggdag<span class="sc">::</span><span class="fu">tidy_dagitty</span>(dag_one_t)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate second set of coordinates for edge-arc </span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>dag_one_t <span class="ot">&lt;-</span> </span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>  dag_one_t <span class="sc">|&gt;</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="do">## create second set of coordinates for edge-arc</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x coordinates</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend_arc =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>     name<span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">&amp;</span> to <span class="sc">==</span><span class="st">"X1"</span> <span class="sc">~</span> xend,</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>     name<span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">&amp;</span> to <span class="sc">==</span><span class="st">"Y"</span> <span class="sc">~</span> xend ,</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">.default =</span> <span class="cn">NA</span> </span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># y coordinates</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend_arc =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>      name<span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">&amp;</span> to <span class="sc">==</span><span class="st">"X1"</span> <span class="sc">~</span> yend,</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>      name<span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">&amp;</span> to <span class="sc">==</span><span class="st">"Y"</span> <span class="sc">~</span> yend ,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">.default =</span> <span class="cn">NA</span> </span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># remove straight edge for those flag with arc</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(xend_arc),xend,<span class="cn">NA</span>),</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(yend_arc),yend,<span class="cn">NA</span>),</span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a>    <span class="do">## z coordinates</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> <span class="fu">ifelse</span>(name<span class="sc">==</span><span class="st">"Z"</span>,x<span class="fl">+0.1</span>,xend),</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> <span class="fu">ifelse</span>(name<span class="sc">==</span><span class="st">"Z"</span>,y<span class="fl">+0.1</span>,yend)</span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co"># add nodes label for ggplot</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>dag_one_t_labels <span class="ot">&lt;-</span></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(dag_one_t) <span class="sc">|&gt;</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"X0"</span><span class="sc">~</span><span class="st">"X\u2080"</span>,</span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"X1"</span><span class="sc">~</span> <span class="st">"X\u2081"</span>,</span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"L0"</span> <span class="sc">~</span> <span class="st">"L\u2080"</span>,</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"L1"</span> <span class="sc">~</span> <span class="st">"L\u2081"</span>,</span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"Y"</span>  <span class="sc">~</span> <span class="st">"Y"</span>,</span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span><span class="st">"P-1"</span> <span class="sc">~</span> <span class="st">"P\u208b\u2081"</span>,</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>    name <span class="sc">==</span> <span class="st">"Z"</span> <span class="sc">~</span> <span class="st">"Z"</span>)</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">pull</span>(label)</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a><span class="co">#             Create DAG with ggplot             #</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>make_dag_one_t <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">scale_node_size=</span><span class="dv">1</span>, <span class="at">text_size=</span><span class="dv">4</span>, <span class="at">default_node_size=</span><span class="dv">16</span>){</span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>  node_size <span class="ot">&lt;-</span> default_node_size <span class="sc">*</span> scale_node_size</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>fig_dag_one_t <span class="ot">&lt;-</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>  dag_one_t  <span class="sc">|&gt;</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> x,</span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> y,</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend =</span> xend,</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend =</span> yend</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="at">size =</span> node_size) <span class="sc">+</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>() <span class="sc">+</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges_arc</span>(<span class="fu">aes</span>(<span class="at">xend=</span>xend_arc,<span class="at">yend=</span>yend_arc), <span class="at">curvature=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>dag_one_t_labels), <span class="at">size=</span>text_size) <span class="sc">+</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="co">#title="Hypothesized relationship between diet, physical activity and outcome",</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Arrows from Z to L, X, Y are not shown"</span>) <span class="sc">+</span></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_dag</span>() <span class="sc">+</span> </span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"white"</span>)</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(fig_dag_one_t)</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate figure for different layout</span></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a><span class="do">## normal version</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>fig_dag_one_t_normal <span class="ot">&lt;-</span> </span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_dag_one_t</span>(<span class="at">text_size=</span><span class="dv">7</span>)</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="do">## JMIR format</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>fig_dag_one_t_jmir <span class="ot">&lt;-</span> </span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_dag_one_t</span>(<span class="at">scale_node_size=</span><span class="fl">0.5</span>, <span class="at">text_size=</span><span class="fl">3.5</span>) <span class="sc">+</span> </span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">6</span>))</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a><span class="co">#                Save as png/pdf                 #</span></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_1t.pdf"</span>),</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_one_t_normal, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">8</span>,<span class="at">height=</span><span class="fl">4.5</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="fl">0.85</span>,<span class="at">device =</span> cairo_pdf)</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_1t.png"</span>),</span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_one_t_normal, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">8</span>,<span class="at">height=</span><span class="fl">4.5</span>, <span class="at">units=</span><span class="st">"in"</span>,<span class="at">scale=</span><span class="fl">0.85</span>)</span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggsave</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_1t_jmir.png"</span>),</span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a>                <span class="at">plot=</span>fig_dag_one_t_jmir, <span class="at">dpi=</span><span class="dv">300</span>, <span class="at">width=</span><span class="dv">1200</span>,<span class="at">height=</span><span class="dv">800</span>, <span class="at">units=</span><span class="st">"px"</span>,<span class="at">scale=</span><span class="dv">1</span>)</span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a><span class="co">#              Load rendered figure              #</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a><span class="co"># ********************************************** #</span></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="fu">file.path</span>(dir_fig,<span class="st">"fig_dag_1t.png"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-dag-one-t" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dag-one-t-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="manuscript/figures/fig_dag_1t.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dag-one-t-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Directed acyclic graph (DAG) depicting the hypothesized relationship among prior dietary exposure and time-varying interventions (diet, physical activity) and covariates. Arrows from the Z node are not shown for clarity, but would point towards all baseline and time-varying nodes, as well as outcome. Only one follow-up is shown for visualization purpose, but the hypothesized causal structure extends to additional follow-ups.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The intention-to-treat analysis is similar to the per protocol analysis. However, only baseline diet and physical activity habits and covariates are considered as well as pre-baseline diet and physical activity. In both the per protocol and intention-to-treat analyses, loss to follow-up (e.g., non-response or missing follow-up, health outcomes not measured) will be accounted for using g-methods such as inverse probability weighting.</p>
<section id="dietary-assessment" class="level4">
<h4 class="anchored" data-anchor-id="dietary-assessment">Dietary Assessment</h4>
<p>In the NuAge study, diet during the year before baseline was assessed using one semi-quantitative food-frequency questionnaire <span class="citation" data-cites="shatenstein2005">[<a href="#ref-shatenstein2005" role="doc-biblioref">47</a>]</span>. Dietary intakes at baseline (time 0) and each annual follow-ups (time 1, 2 and 3) were assessed using 3 repeated face-to-face interviewer-administered 24-hour dietary recall.</p>
<p>Dietary intakes measured using 24-h dietary recall are more accurate (i.e., less systematic error or bias) than food-frequency questionnaire <span class="citation" data-cites="freedman2014 freedman2015 thompson2015">[<a href="#ref-freedman2014" role="doc-biblioref">48</a>–<a href="#ref-thompson2015" role="doc-biblioref">50</a>]</span> but are particularly affected by random measurement error (i.e., within-individual random error) <span class="citation" data-cites="thompson2015">[<a href="#ref-thompson2015" role="doc-biblioref">50</a>]</span>. When several variables measured with errors are considered simultaneously in a regression model, the regression coefficients may be biased in any direction <span class="citation" data-cites="keogh2020">[<a href="#ref-keogh2020" role="doc-biblioref">51</a>]</span>. To account for random measurement error, the National Cancer Institute Markov Chain Monte Carlo (MCMC) multivariate method could be applied <span class="citation" data-cites="zhang2011">[<a href="#ref-zhang2011" role="doc-biblioref">52</a>]</span>. However, the combination of the parametric g-formula and multivariate measurement error correction using the NCI MCMC method is not feasible. The NCI MCMC method estimates time-invariant measurement error-corrected intakes, while the g formula algorithm is designed for time-varying exposures.</p>
<p>Recognizing the importance of accounting for measurement error, the correction for measurement error will be reserved for the secondary intention-to-treat analysis. For the intention-to-treat contrast, the time-varying values of exposure and the time-varying values of confounding are not considered. Thus, the NCI MCMC method will be used to obtain measurement error-corrected estimates of the relationship between dietary intakes measured at baseline and outcome at the end of follow-up. Of note, the three 24-h dietary recalls collected at each time point contribute to reducing random errors, at least to some extent, even in absence of measurement error correction.</p>
<section id="sensitivity-analysis-to-assess-the-impact-of-measurement-error" class="level5">
<h5 class="anchored" data-anchor-id="sensitivity-analysis-to-assess-the-impact-of-measurement-error">Sensitivity analysis to assess the impact of measurement error</h5>
<p>For the secondary intention-to-treat analysis, results based on the measurement error-corrected and uncorrected dietary intakes will be compared. The difference between the estimated relationships will allow to extrapolate the impact of not accounting for random errors in the primary <em>per protocol</em> analysis.</p>
</section>
</section>
<section id="physical-activity-assessment" class="level4">
<h4 class="anchored" data-anchor-id="physical-activity-assessment">Physical activity assessment</h4>
<p>Physical activity throughout the study was assessed using the Physical Activity Scale for the Elderly (PASE) questionnaire <span class="citation" data-cites="washburn1993 washburn1999">[<a href="#ref-washburn1993" role="doc-biblioref">53</a>,<a href="#ref-washburn1999" role="doc-biblioref">54</a>]</span>. Rather than the total PASE score, specific questions estimating the total time of physical activities will be used to be consistent with the intervention strategy.</p>
</section>
<section id="covariates-and-subgroups" class="level4">
<h4 class="anchored" data-anchor-id="covariates-and-subgroups">Covariates and subgroups</h4>
<p>To the extent permitted by the number of observations for each outcome, continuous covariates will be modelled using restricted cubic splines with 3 to 5 knots (at percentiles 10-50-90, 5-35-65-95 or 5-27.5-50-77.5-95) <span class="citation" data-cites="kyle2019">[<a href="#ref-kyle2019" role="doc-biblioref">55</a>]</span>. Categorical covariates will be modelled to ensure a sufficient sample size in each level.</p>
<p>The effect of dietary changes will be estimated for the full sample. The sample will also be stratified by (biological) sex to reflect both potential biological differences and, to some extent, gender differences (although not reported).</p>
</section>
<section id="variance-estimation" class="level4">
<h4 class="anchored" data-anchor-id="variance-estimation">Variance estimation</h4>
<p>Variance will be estimated using a minimum of 200 bootstrap sample replicates to consider uncertainty at each step of the estimation <span class="citation" data-cites="bland2015">[<a href="#ref-bland2015" role="doc-biblioref">56</a>]</span>.</p>
</section>
<section id="software-and-code" class="level4">
<h4 class="anchored" data-anchor-id="software-and-code">Software and code</h4>
<p>The main statistical analyses will be conducted using R (version 4.3.1 or greater) and the gfoRmula package <span class="citation" data-cites="gfoRmula mcgrath2020">[<a href="#ref-mcgrath2020" role="doc-biblioref">44</a>,<a href="#ref-gfoRmula" role="doc-biblioref">57</a>]</span>. The manuscript results will be generated using Quarto markdown. Codes for main analyses and generation of manuscript results will be shared in a publicly available code repository.</p>
</section>
</section>
</section>
<section id="ethical-considerations" class="level2">
<h2 class="anchored" data-anchor-id="ethical-considerations">Ethical Considerations</h2>
<section id="human-subject-ethics-review-approvals-or-exemptions" class="level3">
<h3 class="anchored" data-anchor-id="human-subject-ethics-review-approvals-or-exemptions">Human subject ethics review approvals or exemptions</h3>
<p>The original NuAge study protocol was approved by the Research Ethics Boards of the <em>Institut universitaire de gériatrie de Montréal</em> and the <em>Institut universitaire de gériatrie de Sherbrooke</em> (Quebec, Canada). The NuAge Database and Biobank <span class="citation" data-cites="nuage2024">[<a href="#ref-nuage2024" role="doc-biblioref">58</a>]</span> has received approval by the Research Ethics Board of the <em>Centre intégré universitaire de santé et de services sociaux de l’Estrie—Centre hospitalier universitaire de Sherbrooke</em>. Secondary analyses of data from the NuAge Database and Biobank for the study described in this protocol are approved by the McGill University Research Ethics Board Office (#22-11-041).</p>
</section>
<section id="informed-consent" class="level3">
<h3 class="anchored" data-anchor-id="informed-consent">Informed Consent</h3>
<p>All participants of the NuAge study provided informed consent. From the initial cohort of 1,793 participants, 1,753 (98%) agreed to the integration of their data and biological samples into the NuAge Database and Biobank for future studies.</p>
</section>
<section id="privacy-and-confidentiality" class="level3">
<h3 class="anchored" data-anchor-id="privacy-and-confidentiality">Privacy and confidentiality</h3>
<p>Secondary analyses based on the NuAge Database and Biobank use de-identified data, which do not allow participants to be identified by the investigators.</p>
</section>
<section id="compensation-details" class="level3">
<h3 class="anchored" data-anchor-id="compensation-details">Compensation details</h3>
<p>Participants from the NuAge study voluntarily consented to participate and were not provided with monetary compensation.</p>
</section>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<p>Data collection for the NuAge study was completed in June 2008. For the present work, the main analysis based on the final curated data started in May 2024. The manuscript will be written according to the Strengthening the Reporting of Observational Studies in Epidemiology (STROBE) statement. We anticipate the submission of the manuscript to peer-reviewed academic journal by December 2024.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>In this study protocol, we have described a target trial to assess the effect of adhering to CFG’s recommendations on healthy food choices. The emulation will be performed using data from the NuAge Database and Biobank <span class="citation" data-cites="nuage2024">[<a href="#ref-nuage2024" role="doc-biblioref">58</a>]</span>. Benefiting from the flexibility of observational data, we also aim to compare adherence to multiple reformulations of CFG’s recommendations, including the effect of increasing the intake of protein-rich foods and the amount of aerobic physical activity on selected health outcomes. We have also described the rationale for using simulated diets to emulate the adherence to CFG’s recommendations, the process of selecting covariates - to attempt - to emulate randomization with causal diagrams, and the challenges of addressing random measurement error.</p>
<p>We emphasize that the purpose of emulating a target trial using observational data is to improve the quality of observational analysis <span class="citation" data-cites="hernan2016a hernan2022">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>,<a href="#ref-hernan2022" role="doc-biblioref">14</a>]</span>. In other words, the target trial framework aims to support the coherence between the (causal) research question and the observational data analysis <span class="citation" data-cites="hernan2018">[<a href="#ref-hernan2018" role="doc-biblioref">26</a>]</span>. However, estimating causal effects with non-experimental observational data depends on strong assumptions. The key assumptions are that there are no unmeasured confounder, no measurement error and no model misspecification (e.g., functional form of covariates, model outcome distribution) <span class="citation" data-cites="chiu2021">[<a href="#ref-chiu2021" role="doc-biblioref">19</a>]</span>. We first recognize that the absence of residual or unmeasured confounding cannot be guaranteed. The extent to which this assumption is sufficiently satisfied depends on the appraisal of covariates considered. In that regard, we have used graphical tools, DAG, to explicitly describe our analytical assumptions and to identify confounding variables <span class="citation" data-cites="greenland1999 tennant2021 lipsky2022">[<a href="#ref-greenland1999" role="doc-biblioref">59</a>–<a href="#ref-lipsky2022" role="doc-biblioref">61</a>]</span>. Second, the absence of measurement error assumption will not be satisfied considering the use of dietary intake data measured with 24-h dietary recalls. On one hand, 24-h dietary recalls have the least systematic error (bias) compared with other common instruments such as food-frequency questionnaire <span class="citation" data-cites="freedman2014 freedman2015">[<a href="#ref-freedman2014" role="doc-biblioref">48</a>,<a href="#ref-freedman2015" role="doc-biblioref">49</a>]</span>. On the other hand, 24-h dietary recalls are largely affected by within-individual random errors <span class="citation" data-cites="thompson2015">[<a href="#ref-thompson2015" role="doc-biblioref">50</a>]</span>, which can cause bias in any direction in multivariable models <span class="citation" data-cites="keogh2020">[<a href="#ref-keogh2020" role="doc-biblioref">51</a>]</span>, as in the present study. This issue is mitigated, at least to some extent, by using average data from three repeated 24-h dietary recalls at each follow-up. Sensitivity analyses comparing estimates based on measurement-error corrected and uncorrected baseline dietary intakes will be used to assess the impact of random measurement errors. Third, the absence of model misspecification will be assessed by examining differences between the observed value of time-varying covariates and the predicted value of time-varying covariates as modeled with the g-formula.</p>
<section id="limitations" class="level2">
<h2 class="anchored" data-anchor-id="limitations">Limitations</h2>
<p>Strengths of this study and protocol include the explicit emulation of a hypothetical trial, the thorough description of the emulation of the sustained dietary intervention, and the use of background knowledge and DAG to derive a sufficient set of confounders. Limitations must be addressed. First, the sample size of the NuAge study is relatively limited (n=1753), although comprehensive nutrition and covariate data was collected. Second, the target food intakes based on diet simulations from Health Canada <em>exceed</em> the 99<sup>th</sup> percentile of the usual intake distribution of Canadians 65 years or older from Canada in 2015 <span class="citation" data-cites="brassard2023">[<a href="#ref-brassard2023" role="doc-biblioref">3</a>]</span>. The <em>a posteriori</em> revision of the dietary intervention targets will be needed if observed dietary intakes in NuAge are too far from targets (Table 2), as was done in a previous nutrition target trial emulation <span class="citation" data-cites="ibsen2023">[<a href="#ref-ibsen2023" role="doc-biblioref">22</a>]</span>. Third, the presence of random measurement error associated with 24-h dietary recalls may bias estimates. Finally, the target trial emulation cannot replace an actual RCT. Evidence from RCT will be required to confirm the value of either CFG recommendations or the enhanced CFG recommendations.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In conclusion, the target trial framework is relevant to estimate the causal effect of adhering to CFG’s recommendations using non-experimental data when a RCT is impractical <span class="citation" data-cites="hernan2016a chiu2021">[<a href="#ref-hernan2016a" role="doc-biblioref">11</a>,<a href="#ref-chiu2021" role="doc-biblioref">19</a>]</span>. Coupled with key assumptions, including the absence of unmeasured confounding, the absence of measurement error and no model misspecification, we believe the emulation will provide timely evidence regarding the effect of adhering to CFG’s recommendations in older adults and inform on the added value of a reformulation.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="acknowledgements" class="level1">
<h1>Acknowledgements</h1>
<section id="authors-contributions" class="level2">
<h2 class="anchored" data-anchor-id="authors-contributions">Authors’ contributions</h2>
<p>Conceptualization: all authors; Methodology: DB and SC; Data curation, formal analysis, visualization and writing – original draft: DB; Supervision: SC; Writing – review &amp; editing: all authors.</p>
</section>
<section id="conflicts-of-interest" class="level2">
<h2 class="anchored" data-anchor-id="conflicts-of-interest">Conflicts of Interest</h2>
<p>DB was a casual employee of Health Canada (2019-2020) and held a doctoral training award from the Fonds de recherche du Québec – Santé (2019-2021). DB has no conflicts of interest. SC receives research funding from the CIHR, <em>Fonds de recherche du Québec</em>, Canadian Foundation for Dietetics Research, Canadian Foundation for Innovation and Canadian Cancer Society. None of these agencies has funded nor was involved in this work.</p>
<p>NP is the NuAge Database Administrator; NP and SC serve as NuAge Steering Committee Members.</p>
<p>The NuAge Study was supported by a research grant from the Canadian Institutes of Health Research (CIHR; MOP-62842). The NuAge Database and Biobank are supported by the Fonds de recherche du Québec (FRQ; 2020-VICO-279753), the Quebec Network for Research on Aging, a thematic network funded by the Fonds de Recherche du Québec - Santé (FRQS) and by the Merck-Frosst Chair funded by La Fondation de l’Université de Sherbrooke.</p>
</section>
<section id="funding-statement" class="level2">
<h2 class="anchored" data-anchor-id="funding-statement">Funding statement</h2>
<p>This work was supported by a Canadian Institutes of Health Research (CIHR) Fellowship award (MFE-181852) to DB.</p>
</section>
<section id="data-availability-and-code" class="level2">
<h2 class="anchored" data-anchor-id="data-availability-and-code">Data availability and code</h2>
<p>The data and code used for this manuscript will be made available at https://github.com/didierbrassard/NuAge_protocol</p>
<p><strong>Multimedia Appendix 1</strong>: Supplemental Table 1. HEFI-2019 dietary constituents and score among simulated diets by Health Canada, by age and sex group</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-healthcanada2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Health Canada. Canada’s dietary guidelines - for health professionals and policy makers. 2019. Available from: <a href="https://food-guide.canada.ca/en/guidelines/">https://food-guide.canada.ca/en/guidelines/ </a></div>
</div>
<div id="ref-healthcanada2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Health Canada. Food, nutrients and health: Interim evidence update 2018 for health professionals and policy makers. 2019. Available from: <a href="https://www.canada.ca/content/dam/hc-sc/documents/services/canada-food-guide/resources/evidence/food-nutrients-health-interim-evidence-update-2018/pub1-eng.pdf">https://www.canada.ca/content/dam/hc-sc/documents/services/canada-food-guide/resources/evidence/food-nutrients-health-interim-evidence-update-2018/pub1-eng.pdf </a></div>
</div>
<div id="ref-brassard2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Brassard D, Chevalier S. Relationship between adherence to the 2019 canada’s food guide recommendations on healthy food choices and nutrient intakes in older adults. J Nutr 2023;153(9):2699–2708. doi: <a href="https://doi.org/10.1016/j.tjnut.2023.07.005">10.1016/j.tjnut.2023.07.005</a></div>
</div>
<div id="ref-ramagemorin2013" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Ramage-Morin PL, Garriguet D. Nutritional risk among older canadians. Health Rep 2013;24(3):3–13. Available from: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24257971">https://www.ncbi.nlm.nih.gov/pubmed/24257971 </a></div>
</div>
<div id="ref-mills2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Mills CM, Keller HH, DePaul VG, Donnelly C. Factors associated with the development of high nutrition risk: Data from the canadian longitudinal study on aging. Can J Aging 2023;1–14. doi: <a href="https://doi.org/10.1017/S0714980823000545">10.1017/S0714980823000545</a></div>
</div>
<div id="ref-bauer2013" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Bauer J, Biolo G, Cederholm T, Cesari M, Cruz-Jentoft AJ, Morley JE, Phillips S, Sieber C, Stehle P, Teta D, Visvanathan R, Volpi E, Boirie Y. Evidence-based recommendations for optimal dietary protein intake in older people: A position paper from the PROT-AGE study group. J Am Med Dir Assoc 2013;14(8):542–59. doi: <a href="https://doi.org/10.1016/j.jamda.2013.05.021">10.1016/j.jamda.2013.05.021</a></div>
</div>
<div id="ref-deutz2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Deutz NE, Bauer JM, Barazzoni R, Biolo G, Boirie Y, Bosy-Westphal A, Cederholm T, Cruz-Jentoft A, Krznaric Z, Nair KS, Singer P, Teta D, Tipton K, Calder PC. Protein intake and exercise for optimal muscle function with aging: Recommendations from the ESPEN expert group. Clin Nutr 2014;33(6):929–36. doi: <a href="https://doi.org/10.1016/j.clnu.2014.04.007">10.1016/j.clnu.2014.04.007</a></div>
</div>
<div id="ref-paddonjones2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Paddon-Jones D, Campbell WW, Jacques PF, Kritchevsky SB, Moore LL, Rodriguez NR, Loon LJ van. Protein and healthy aging. Am J Clin Nutr 2015;101(6):1339S–1345S. doi: <a href="https://doi.org/10.3945/ajcn.114.084061">10.3945/ajcn.114.084061</a></div>
</div>
<div id="ref-remond2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">Remond D, Shahar DR, Gille D, Pinto P, Kachal J, Peyron MA, Dos Santos CN, Walther B, Bordoni A, Dupont D, Tomas-Cobos L, Vergeres G. Understanding the gastrointestinal tract of the elderly to develop dietary solutions that prevent malnutrition. Oncotarget 2015;6(16):13858–98. doi: <a href="https://doi.org/10.18632/oncotarget.4030">10.18632/oncotarget.4030</a></div>
</div>
<div id="ref-shlisky2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Shlisky J, Bloom DE, Beaudreault AR, Tucker KL, Keller HH, Freund-Levi Y, Fielding RA, Cheng FW, Jensen GL, Wu D, Meydani SN. Nutritional considerations for healthy aging and reduction in age-related chronic disease. Adv Nutr 2017;8(1):17–26. doi: <a href="https://doi.org/10.3945/an.116.013474">10.3945/an.116.013474</a></div>
</div>
<div id="ref-hernan2016a" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Hernan MA, Robins JM. Using big data to emulate a target trial when a randomized trial is not available. Am J Epidemiol 2016;183(8):758–64. doi: <a href="https://doi.org/10.1093/aje/kwv254">10.1093/aje/kwv254</a></div>
</div>
<div id="ref-kutcher2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Kutcher SA, Brophy JM, Banack HR, Kaufman JS, Samuel M. Emulating a randomised controlled trial with observational data: An introduction to the target trial framework. Can J Cardiol 2021;37(9):1365–1377. doi: <a href="https://doi.org/10.1016/j.cjca.2021.05.012">10.1016/j.cjca.2021.05.012</a></div>
</div>
<div id="ref-tobias2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Tobias DK, Lajous M. What would the trial be? Emulating randomized dietary intervention trials to estimate causal effects with observational data. Am J Clin Nutr 2021;114(2):416–417. doi: <a href="https://doi.org/10.1093/ajcn/nqab169">10.1093/ajcn/nqab169</a></div>
</div>
<div id="ref-hernan2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Hernan MA, Wang W, Leaf DE. Target trial emulation: A framework for causal inference from observational data. JAMA 2022;328(24):2446–2447. doi: <a href="https://doi.org/10.1001/jama.2022.21383">10.1001/jama.2022.21383</a></div>
</div>
<div id="ref-stern2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Stern D, Ibsen DB, MacDonald CJ, Chiu YH, Lajous M, Tobias DK. Improving nutrition science begins with asking better questions. Am J Epidemiol 2024;193(11):1507–1510. doi: <a href="https://doi.org/10.1093/aje/kwae110">10.1093/aje/kwae110</a></div>
</div>
<div id="ref-tobias2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">Tobias DK. What eggsactly are we asking here? Unscrambling the epidemiology of eggs, cholesterol, and mortality. Circulation 2022;145(20):1521–1523. doi: <a href="https://doi.org/10.1161/CIRCULATIONAHA.122.059393">10.1161/CIRCULATIONAHA.122.059393</a></div>
</div>
<div id="ref-tomova2022b" class="csl-entry" role="listitem">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Tomova GD, Arnold KF, Gilthorpe MS, Tennant PWG. Adjustment for energy intake in nutritional research: A causal inference perspective. Am J Clin Nutr 2022;115(1):189–198. doi: <a href="https://doi.org/10.1093/ajcn/nqab266">10.1093/ajcn/nqab266</a></div>
</div>
<div id="ref-hernan2016c" class="csl-entry" role="listitem">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Hernan MA, Sauer BC, Hernandez-Diaz S, Platt R, Shrier I. Specifying a target trial prevents immortal time bias and other self-inflicted injuries in observational analyses. J Clin Epidemiol 2016;79:70–75. doi: <a href="https://doi.org/10.1016/j.jclinepi.2016.04.014">10.1016/j.jclinepi.2016.04.014</a></div>
</div>
<div id="ref-chiu2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">19. </div><div class="csl-right-inline">Chiu YH, Chavarro JE, Dickerman BA, Manson JE, Mukamal KJ, Rexrode KM, Rimm EB, Hernan MA. Estimating the effect of nutritional interventions using observational data: The american heart association’s 2020 dietary goals and mortality. Am J Clin Nutr 2021;114(2):690–703. doi: <a href="https://doi.org/10.1093/ajcn/nqab100">10.1093/ajcn/nqab100</a></div>
</div>
<div id="ref-berkowitz2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">20. </div><div class="csl-right-inline">Berkowitz SA, Basu S, Hanmer J. Eliminating food insecurity in the USA: A target trial emulation using observational data to estimate effects on health-related quality of life. J Gen Intern Med 2023;38(10):2308–2317. doi: <a href="https://doi.org/10.1007/s11606-023-08095-6">10.1007/s11606-023-08095-6</a></div>
</div>
<div id="ref-bonekamp2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">21. </div><div class="csl-right-inline">Bonekamp NE, Cruijsen E, Visseren FL, Schouw YT van der, Geleijnse JM, Koopal C. Compliance with the DASH diet and risk of all-cause and cardiovascular mortality in patients with myocardial infarction. Clin Nutr 2023;42(8):1418–1426. doi: <a href="https://doi.org/10.1016/j.clnu.2023.06.033">10.1016/j.clnu.2023.06.033</a></div>
</div>
<div id="ref-ibsen2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">22. </div><div class="csl-right-inline">Ibsen DB, Chiu YH, Gemes K, Wolk A. Hypothetical 22-year intervention with DASH diet lowered risk of heart failure in a general population. Am J Epidemiol 2023; doi: <a href="https://doi.org/10.1093/aje/kwad181">10.1093/aje/kwad181</a></div>
</div>
<div id="ref-dickerman2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">23. </div><div class="csl-right-inline">Dickerman BA, Giovannucci E, Pernar CH, Mucci LA, Hernan MA. Guideline-based physical activity and survival among US men with nonmetastatic prostate cancer. Am J Epidemiol 2019;188(3):579–586. doi: <a href="https://doi.org/10.1093/aje/kwy261">10.1093/aje/kwy261</a></div>
</div>
<div id="ref-guo2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">24. </div><div class="csl-right-inline">Guo F, McGee EE, Chiu YH, Giovannucci E, Mucci LA, Dickerman BA. Evaluating recommendation-based dietary and physical activity strategies for prostate cancer prevention: A target trial emulation in the health professionals follow-up study. Am J Epidemiol 2024; doi: <a href="https://doi.org/10.1093/aje/kwae184">10.1093/aje/kwae184</a></div>
</div>
<div id="ref-gaudreau2007" class="csl-entry" role="listitem">
<div class="csl-left-margin">25. </div><div class="csl-right-inline">Gaudreau P, Morais JA, Shatenstein B, Gray-Donald K, Khalil A, Dionne I, Ferland G, Fulop T, Jacques D, Kergoat MJ, Tessier D, Wagner R, Payette H. Nutrition as a determinant of successful aging: Description of the quebec longitudinal study nuage and results from cross-sectional pilot studies. Rejuvenation Res 2007;10(3):377–86. doi: <a href="https://doi.org/10.1089/rej.2007.0596">10.1089/rej.2007.0596</a></div>
</div>
<div id="ref-hernan2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">26. </div><div class="csl-right-inline">Hernan MA. The c-word: Scientific euphemisms do not improve causal inference from observational data. Am J Public Health 2018;108(5):616–619. doi: <a href="https://doi.org/10.2105/AJPH.2018.304337">10.2105/AJPH.2018.304337</a></div>
</div>
<div id="ref-goetghebeur2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">27. </div><div class="csl-right-inline">Goetghebeur E, Cessie S le, De Stavola B, Moodie EE, Waernbaum I, Causal Inference of the S initiative on behalf of" the topic group. Formulating causal questions and principled statistical answers. Stat Med 2020;39(30):4922–4948. doi: <a href="https://doi.org/10.1002/sim.8741">10.1002/sim.8741</a></div>
</div>
<div id="ref-haber2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">28. </div><div class="csl-right-inline">Haber NA, Wieten SE, Rohrer JM, Arah OA, Tennant PWG, Stuart EA, Murray EJ, Pilleron S, Lam ST, Riederer E, Howcutt SJ, Simmons AE, Leyrat C, Schoenegger P, Booman A, Dufour MK, O’Donoghue AL, Baglini R, Do S, Takashima MR, Evans TR, Rodriguez-Molina D, Alsalti TM, Dunleavy DJ, Meyerowitz-Katz G, Antonietti A, Calvache JA, Kelson MJ, Salvia MG, Parra CO, Khalatbari-Soltani S, McLinden T, Chatton A, Seiler J, Steriu A, Alshihayb TS, Twardowski SE, Dabravolskaj J, Au E, Hoopsick RA, Suresh S, Judd N, Pena S, Axfors C, Khan P, Rivera Aguirre AE, Odo NU, Schmid I, Fox MP. Causal and associational language in observational health research: A systematic evaluation. Am J Epidemiol 2022; doi: <a href="https://doi.org/10.1093/aje/kwac137">10.1093/aje/kwac137</a></div>
</div>
<div id="ref-brassard2022a" class="csl-entry" role="listitem">
<div class="csl-left-margin">29. </div><div class="csl-right-inline">Brassard D, Elvidge Munene LA, St-Pierre S, Guenther PM, Kirkpatrick SI, Slater J, Lemieux S, Jessri M, Haines J, Prowse R, Olstad DL, Garriguet D, Vena J, Vatanparast H, L’Abbe MR, Lamarche B. Development of the healthy eating food index (HEFI)-2019 measuring adherence to canada’s food guide 2019 recommendations on healthy food choices. Appl Physiol Nutr Metab 2022;47(5):595–610. doi: <a href="https://doi.org/10.1139/apnm-2021-0415">10.1139/apnm-2021-0415</a></div>
</div>
<div id="ref-hernan2016b" class="csl-entry" role="listitem">
<div class="csl-left-margin">30. </div><div class="csl-right-inline">Hernan MA. Does water kill? A call for less casual causal inferences. Ann Epidemiol 2016;26(10):674–680. doi: <a href="https://doi.org/10.1016/j.annepidem.2016.08.016">10.1016/j.annepidem.2016.08.016</a></div>
</div>
<div id="ref-chiu2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">31. </div><div class="csl-right-inline">Chiu YH. Well-defined interventions for nutritional studies: From target trials to nutritional modeling. Am J Clin Nutr 2022;115(1):3–5. doi: <a href="https://doi.org/10.1093/ajcn/nqab343">10.1093/ajcn/nqab343</a></div>
</div>
<div id="ref-kipnis1993" class="csl-entry" role="listitem">
<div class="csl-left-margin">32. </div><div class="csl-right-inline">Kipnis V, Freedman LS, Brown CC, Hartman A, Schatzkin A, Wacholder S. Interpretation of energy adjustment models for nutritional epidemiology. Am J Epidemiol 1993;137(12):1376–80. doi: <a href="https://doi.org/10.1093/oxfordjournals.aje.a116647">10.1093/oxfordjournals.aje.a116647</a></div>
</div>
<div id="ref-tomova2022a" class="csl-entry" role="listitem">
<div class="csl-left-margin">33. </div><div class="csl-right-inline">Tomova GD, Gilthorpe MS, Tennant PWG. Theory and performance of substitution models for estimating relative causal effects in nutritional epidemiology. Am J Clin Nutr 2022;116(5):1379–88. doi: <a href="https://doi.org/10.1093/ajcn/nqac188">10.1093/ajcn/nqac188</a></div>
</div>
<div id="ref-healthcanada2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">34. </div><div class="csl-right-inline">Health Canada. Simulated composite diets. Open Government Portal; 2022. Available from: <a href="https://open.canada.ca/data/en/dataset/0490749d-b0b0-410a-9577-a903c6cec2be">https://open.canada.ca/data/en/dataset/0490749d-b0b0-410a-9577-a903c6cec2be </a></div>
</div>
<div id="ref-brassard2022b" class="csl-entry" role="listitem">
<div class="csl-left-margin">35. </div><div class="csl-right-inline">Brassard D, Elvidge Munene LA, St-Pierre S, Gonzalez A, Guenther PM, Jessri M, Vena J, Olstad DL, Vatanparast H, Prowse R, Lemieux S, L’Abbe MR, Garriguet D, Kirkpatrick SI, Lamarche B. Evaluation of the healthy eating food index (HEFI)-2019 measuring adherence to canada’s food guide 2019 recommendations on healthy food choices. Appl Physiol Nutr Metab 2022;47(5):582–594. doi: <a href="https://doi.org/10.1139/apnm-2021-0416">10.1139/apnm-2021-0416</a></div>
</div>
<div id="ref-willett2013" class="csl-entry" role="listitem">
<div class="csl-left-margin">36. </div><div class="csl-right-inline">Willett W. Nutritional epidemiology. 3rd ed. Oxford: Oxford University Press; 2013. p. 529. ISBN:9780199754038 (hardcover alk. paper)</div>
</div>
<div id="ref-willett2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">37. </div><div class="csl-right-inline">Willett WC, Stampfer M, Tobias DK. Re: Adjustment for energy intake in nutritional research: A causal inference perspective. Am J Clin Nutr 2022;116(2):608–609. doi: <a href="https://doi.org/10.1093/ajcn/nqac114">10.1093/ajcn/nqac114</a></div>
</div>
<div id="ref-harrison2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">38. </div><div class="csl-right-inline">Harrison S, Brassard D, Garriguet D, Lemieux S, Lamarche B. A food-level substitution analysis assessing the impact of replacing regular-fat dairy with lower fat dairy on saturated fat intake at a population level in canada. Am J Clin Nutr 2021;114(5):1830–1836. doi: <a href="https://doi.org/10.1093/ajcn/nqab251">10.1093/ajcn/nqab251</a></div>
</div>
<div id="ref-harrison2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">39. </div><div class="csl-right-inline">Harrison S, Lemieux S, Lamarche B. Assessing the impact of replacing foods high in saturated fats with foods high in unsaturated fats on dietary fat intake among canadians. Am J Clin Nutr 2022;115(3):877–885. doi: <a href="https://doi.org/10.1093/ajcn/nqab420">10.1093/ajcn/nqab420</a></div>
</div>
<div id="ref-daly2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">40. </div><div class="csl-right-inline">Daly RM, O’Connell SL, Mundell NL, Grimes CA, Dunstan DW, Nowson CA. Protein-enriched diet, with the use of lean red meat, combined with progressive resistance training enhances lean tissue mass and muscle strength and reduces circulating IL-6 concentrations in elderly women: A cluster randomized controlled trial. Am J Clin Nutr 2014;99(4):899–910. doi: <a href="https://doi.org/10.3945/ajcn.113.064154">10.3945/ajcn.113.064154</a></div>
</div>
<div id="ref-naimi2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">41. </div><div class="csl-right-inline">Naimi AI, Cole SR, Kennedy EH. An introduction to g methods. Int J Epidemiol 2017;46(2):756–762. doi: <a href="https://doi.org/10.1093/ije/dyw323">10.1093/ije/dyw323</a></div>
</div>
<div id="ref-igelstrom2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">42. </div><div class="csl-right-inline">Igelström E, Craig P, Lewsey J, Lynch J, Pearce A, Katikireddi SV. Causal inference and effect estimation using observational data. Journal of Epidemiology and Community Health 2022;76(11):960. doi: <a href="https://doi.org/10.1136/jech-2022-219267">10.1136/jech-2022-219267</a></div>
</div>
<div id="ref-taubman2009" class="csl-entry" role="listitem">
<div class="csl-left-margin">43. </div><div class="csl-right-inline">Taubman SL, Robins JM, Mittleman MA, Hernan MA. Intervening on risk factors for coronary heart disease: An application of the parametric g-formula. Int J Epidemiol 2009;38(6):1599–611. doi: <a href="https://doi.org/10.1093/ije/dyp192">10.1093/ije/dyp192</a></div>
</div>
<div id="ref-mcgrath2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">44. </div><div class="csl-right-inline">McGrath S, Lin V, Zhang Z, Petito LC, Logan RW, Hernán MA, Young JG. gfoRmula: An r package for estimating the effects of sustained treatment strategies via the parametric g-formula. Patterns 2020;1(3). doi: <a href="https://doi.org/10.1016/j.patter.2020.100008">10.1016/j.patter.2020.100008</a></div>
</div>
<div id="ref-young2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">45. </div><div class="csl-right-inline">Young JG, Hernan MA, Robins JM. Identification, estimation and approximation of risk under interventions that depend on the natural value of treatment using observational data. Epidemiol Methods 2014;3(1):1–19. doi: <a href="https://doi.org/10.1515/em-2012-0001">10.1515/em-2012-0001</a></div>
</div>
<div id="ref-robins1986" class="csl-entry" role="listitem">
<div class="csl-left-margin">46. </div><div class="csl-right-inline">Robins J. A new approach to causal inference in mortality studies with a sustained exposure period—application to control of the healthy worker survivor effect. Mathematical Modelling 1986;7(9):1393–1512. doi: <a href="https://doi.org/10.1016/0270-0255(86)90088-6">https://doi.org/10.1016/0270-0255(86)90088-6</a></div>
</div>
<div id="ref-shatenstein2005" class="csl-entry" role="listitem">
<div class="csl-left-margin">47. </div><div class="csl-right-inline">Shatenstein B, Nadon S, Godin C, Ferland G. Development and validation of a food frequency questionnaire. Can J Diet Pract Res 2005;66(2):67–75. doi: <a href="https://doi.org/10.3148/66.2.2005.67">10.3148/66.2.2005.67</a></div>
</div>
<div id="ref-freedman2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">48. </div><div class="csl-right-inline">Freedman LS, Commins JM, Moler JE, Arab L, Baer DJ, Kipnis V, Midthune D, Moshfegh AJ, Neuhouser ML, Prentice RL, Schatzkin A, Spiegelman D, Subar AF, Tinker LF, Willett W. Pooled results from 5 validation studies of dietary self-report instruments using recovery biomarkers for energy and protein intake. Am J Epidemiol 2014;180(2):172–88. doi: <a href="https://doi.org/10.1093/aje/kwu116">10.1093/aje/kwu116</a></div>
</div>
<div id="ref-freedman2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">49. </div><div class="csl-right-inline">Freedman LS, Commins JM, Moler JE, Willett W, Tinker LF, Subar AF, Spiegelman D, Rhodes D, Potischman N, Neuhouser ML, Moshfegh AJ, Kipnis V, Arab L, Prentice RL. Pooled results from 5 validation studies of dietary self-report instruments using recovery biomarkers for potassium and sodium intake. Am J Epidemiol 2015;181(7):473–87. doi: <a href="https://doi.org/10.1093/aje/kwu325">10.1093/aje/kwu325</a></div>
</div>
<div id="ref-thompson2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">50. </div><div class="csl-right-inline">Thompson FE, Kirkpatrick SI, Subar AF, Reedy J, Schap TE, Wilson MM, Krebs-Smith SM. The national cancer institute’s dietary assessment primer: A resource for diet research. J Acad Nutr Diet 2015;115(12):1986–95. doi: <a href="https://doi.org/10.1016/j.jand.2015.08.016">10.1016/j.jand.2015.08.016</a></div>
</div>
<div id="ref-keogh2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">51. </div><div class="csl-right-inline">Keogh RH, Shaw PA, Gustafson P, Carroll RJ, Deffner V, Dodd KW, Kuchenhoff H, Tooze JA, Wallace MP, Kipnis V, Freedman LS. STRATOS guidance document on measurement error and misclassification of variables in observational epidemiology: Part 1-basic theory and simple methods of adjustment. Stat Med 2020;39(16):2197–2231. doi: <a href="https://doi.org/10.1002/sim.8532">10.1002/sim.8532</a></div>
</div>
<div id="ref-zhang2011" class="csl-entry" role="listitem">
<div class="csl-left-margin">52. </div><div class="csl-right-inline">Zhang S, Midthune D, Guenther PM, Krebs-Smith SM, Kipnis V, Dodd KW, Buckman DW, Tooze JA, Freedman L, Carroll RJ. A new multivariate measurement error model with zero-inflated dietary data, and its application to dietary assessment. Ann Appl Stat 2011;5(2B):1456–1487. doi: <a href="https://doi.org/10.1214/10-AOAS446">10.1214/10-AOAS446</a></div>
</div>
<div id="ref-washburn1993" class="csl-entry" role="listitem">
<div class="csl-left-margin">53. </div><div class="csl-right-inline">Washburn RA, Smith KW, Jette AM, Janney CA. The physical activity scale for the elderly (PASE): Development and evaluation. J Clin Epidemiol 1993;46(2):153–62. doi: <a href="https://doi.org/10.1016/0895-4356(93)90053-4">10.1016/0895-4356(93)90053-4</a></div>
</div>
<div id="ref-washburn1999" class="csl-entry" role="listitem">
<div class="csl-left-margin">54. </div><div class="csl-right-inline">Washburn RA, McAuley E, Katula J, Mihalko SL, Boileau RA. The physical activity scale for the elderly (PASE): Evidence for validity. J Clin Epidemiol 1999;52(7):643–51. doi: <a href="https://doi.org/10.1016/s0895-4356(99)00049-9">10.1016/s0895-4356(99)00049-9</a></div>
</div>
<div id="ref-kyle2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">55. </div><div class="csl-right-inline">Kyle RP, Moodie EEM, Klein MB, Abrahamowicz M. Evaluating flexible modeling of continuous covariates in inverse-weighted estimators. Am J Epidemiol 2019;188(6):1181–1191. doi: <a href="https://doi.org/10.1093/aje/kwz004">10.1093/aje/kwz004</a></div>
</div>
<div id="ref-bland2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">56. </div><div class="csl-right-inline">Bland JM, Altman DG. Statistics notes: Bootstrap resampling methods. BMJ 2015;350:h2622. doi: <a href="https://doi.org/10.1136/bmj.h2622">10.1136/bmj.h2622</a></div>
</div>
<div id="ref-gfoRmula" class="csl-entry" role="listitem">
<div class="csl-left-margin">57. </div><div class="csl-right-inline">Lin V, McGrath S, Zhang Z, Logan RW, Petito LC, Li J, Young JG, Hernán MA. gfoRmula: Parametric g-formula. 2023; Available from: <a href="https://CRAN.R-project.org/package=gfoRmula">https://CRAN.R-project.org/package=gfoRmula </a></div>
</div>
<div id="ref-nuage2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">58. </div><div class="csl-right-inline">Database N, Biobank. Database and biobank of the quebec longitudinal study on nutrition and successful aging. 2024. Available from: <a href="https://nuage.recherche.usherbrooke.ca">https://nuage.recherche.usherbrooke.ca </a></div>
</div>
<div id="ref-greenland1999" class="csl-entry" role="listitem">
<div class="csl-left-margin">59. </div><div class="csl-right-inline">Greenland S, Pearl J, Robins JM. Causal diagrams for epidemiologic research. Epidemiology 1999;10(1):37–48. Available from: <a href="https://www.ncbi.nlm.nih.gov/pubmed/9888278">https://www.ncbi.nlm.nih.gov/pubmed/9888278 </a></div>
</div>
<div id="ref-tennant2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">60. </div><div class="csl-right-inline">Tennant PWG, Murray EJ, Arnold KF, Berrie L, Fox MP, Gadd SC, Harrison WJ, Keeble C, Ranker LR, Textor J, Tomova GD, Gilthorpe MS, Ellison GTH. Use of directed acyclic graphs (DAGs) to identify confounders in applied health research: Review and recommendations. Int J Epidemiol 2021;50(2):620–632. doi: <a href="https://doi.org/10.1093/ije/dyaa213">10.1093/ije/dyaa213</a></div>
</div>
<div id="ref-lipsky2022" class="csl-entry" role="listitem">
<div class="csl-left-margin">61. </div><div class="csl-right-inline">Lipsky AM, Greenland S. Causal directed acyclic graphs. JAMA 2022;327(11):1083–1084. doi: <a href="https://doi.org/10.1001/jama.2022.1816">10.1001/jama.2022.1816</a></div>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="abbreviations" class="level1 unnumbered">
<h1 class="unnumbered">Abbreviations</h1>
<p>CFG: Canada’s Food Guide<br>
DAG: directed acyclic graph<br>
HEFI: Healthy Eating Food Index 2019<br>
MCMC: Markov Chain Monte Carlo<br>
NCI: National Cancer Institute<br>
RA: Reference amount<br>
RCT: randomized controlled trial</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>